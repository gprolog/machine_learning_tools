<?xml version="1.0" encoding="UTF-8"?>
<xmlpattern version="2.05.0000">
   
<basic>
	<baseline>0</baseline>
	<malicious>20</malicious>
	<suspicious>10</suspicious>
</basic>

<rule-set category="Dynamic Script">
	<rule-set category="Generic">
		<rule name="JS.ShellCode.A" weight="20">
			<search target="method">
				<match>concatshellcode</match>
			</search>
		</rule>

		<rule name="JS.ShellCode.B" weight="20">
			<search target="script" encryptedDegree="1">
				<pre-match>unescape</pre-match>
				<regexp>E8|E9|EB</regexp>
			</search>
		</rule>

		<rule name="JS.ShellCode.C" weight="20">
			<search target="script" encryptedDegree="1">
				<search target="method">
					<pre-match>unescape</pre-match>
					<search target="param">
						<pre-match>%u9090%u9090</pre-match>
						<pre-match>%u0505%u0505</pre-match>
						<pre-match>%u0c0c%u0c0c</pre-match>
						<pre-match>%u0d0d%u0d0d</pre-match>
						<pre-match>%u0a0a%u0a0a</pre-match>
						<pre-match>%ucccc%ucccc</pre-match>
					</search>
				</search>
			</search>
		</rule>
			
		<rule name="JS.ShellCode.D" weight="20">
			<search target="script" encryptedDegree="1">
				<search target="method">
	  				<pre-match>unescape</pre-match>
	  				<search target="param">
	  					<pre-match>%u9000%u9090%ucccc</pre-match>
	  					<pre-match>%u1c1c%u1c1c</pre-match>
	  					<pre-match>%u0024%u0c0c</pre-match>
	  					<pre-match>%u001c%u1000</pre-match>
	  					<pre-match>%u9090%u7ceb</pre-match>
	  					<pre-match>%u4141%u4141</pre-match>
	  					<pre-match>%u0000%u0f00</pre-match>
					</search>
	  			</search>	  		
	  		</search>
		</rule>

		<rule name="JS.ShellCode.E" weight="0" feedback="1">
			<search target="script" encryptedDegree="1">
				<search target="method">
					<pre-match>unescape</pre-match>
					<search target="param">
						<pre-match>%u40b0%u4927</pre-match>
					</search>
				</search>
			</search>
		</rule>
		
		<rule name="JS.ShellCode.F" weight="20">
			<search target="script">
				<pre-match>collectgarbage</pre-match>
				<search target="method">
					<match>unescape</match>
						<search target="param">
							<match>%u9090%u9090</match>	
						</search>
				</search>
				<search target="method">
					<match>unescape</match>
						<search target="param">
							<regexp><![CDATA[(%u\w{4}){100,}]]></regexp>
						</search>
				</search>
			</search>
		</rule>
		
		<rule name="JS.RiskAcX.A" weight="0" feedback="1">
			<search target="script" encryptedDegree="1">
				<search target="method">
					<search target="param">
						<pre-match>adodb.stream</pre-match>
						<pre-match>wscript.shell</pre-match>
						<pre-match>ierpctl.ierpctl.1</pre-match>
					</search>
				</search>
	   		</search>
		</rule>

		<rule name="JS.RiskAcX.B" weight="10" feedback="1">
			 <search target="method">
				<pre-match>savetofile</pre-match>
				<search target="object">
					<match>adodb.stream</match>
				</search>
			</search>
			<search target="method">
				<pre-match>shellexecute</pre-match>
				<search target="object">
					<match>shell.application</match>
				</search>
			</search>
		</rule>

		<rule name="JS.RiskAcX.C" weight="10" feedback="1">
			<search target="ALL">
				<pre-match>.savetofile</pre-match>
				<regexp>\.savetofile[\s\S]{0,200}(\.run|\.shellexecute)</regexp>
			</search>
		</rule>

		<rule name="JS.RiskAcX.D" weight="0" feedback="1">
			<search target="ALL">
				<pre-match>.savetofile</pre-match>
				<regexp>\.write[\s\S]{0,200}\.savetofile</regexp>
			</search>
		</rule>

		<rule name="JS.AutoRun.A" weight="5" feedback="1">
	  		<desp>General/Set Auto-Run registry</desp>
	  		<search target="method">
	 			<pre-match>regwrite</pre-match>
				<search target="param">
					<match>microsoft\windows\currentversion\run\</match>
				</search>
	  		</search>
		</rule>

		<rule name="JS.IEStartPage.A" weight="5" feedback="1">
			<desp>General/Set start page</desp>
	  		<search target="method">
	 			<pre-match>regwrite</pre-match>
		  		<search target="param">
		  			<match>internet explorer\main\start page</match>
		  		</search>
	  		</search>
		</rule>

		<rule name="JS.IframeHidden.D" weight="20">
			<desp>General/hidden iframe</desp>
			<search target="method">
				<pre-match>eval</pre-match>
				<search target="param">
					<pre-match>nextrandomnumber</pre-match>
					<pre-match>randomnumbergenerator</pre-match>
					<pre-match>createrandomnumber</pre-match>
					<regexp><![CDATA[document.createelement\(("|')iframe("|')\)[\s\S]{1,300}\.style.(width|height|visibility)\s*(=|:)\W*(0|none|1|2|hidden)\W[^><]*]]></regexp>
				</search>
			</search>
		</rule>

		<rule name="JS.IframeHidden.E" weight="0" feedback="1">
			<desp>General/hidden iframe</desp>
			<search target="method">
				<pre-match>eval</pre-match>
				<search target="object">
					<match>window</match>
				</search>
				<search target="param"> 
					<pre-match>1b21093d46527f41ff429310436e0bf7</pre-match>
					<regexp><![CDATA[try\s*[^{}]{1,300}{[\s\S]{0,200}(width|height|display|visibility)\s*(=|:)\W*(0|none|1|2|hidden)[\s\S]{0,200}iframe]]></regexp>
				</search>
			</search>
		</rule>
		
		<rule name="JS.IframeHidden.F" weight="0" feedback="1">
			<desp>General/hidden iframe</desp>
			<search target="script">
				<pre-match>iframewascreated</pre-match>
				<pre-match>math.round</pre-match>
				<pre-match>var domainname</pre-match>
				<regexp><![CDATA[typeof\s*iframewascreated\s*==\s*('|")?undefined('|")?[\s\S]{0,200}math.round\s*\(\W*new\s*date[\s\S]{0,200}var\s*domainname]]></regexp>
			</search>
		</rule>		

		<rule name="JS.IframeHidden.GA" weight="0" feedback="1">
			<desp>General/hidden iframe</desp>
            <search target="script">
                <match>fromcharcode</match>
                <regexp><![CDATA[=\s*['"]([\da-zA-Z]{2}_){1000}]]></regexp>
                <search target="method">
                    <match>eval</match>
                    <search target="object">
                        <match>window</match>
                    </search>
                    <search target="param">
                        <match>document.createelement(</match>
                    </search>
                </search>
            </search>
			<search target="script" encryptedDegree="1">
				<search target="method">
					<match>createelement</match>
					<search target="param">
                        <match>iframe</match>
					</search>
				</search>
			</search>
		</rule>
        
        <rule name="JS.IframeHidden.GAA" weight="0" feedback="1">
			<desp>General/hidden iframe</desp>
            <search target="script">
                <match>fromcharcode</match>
                <regexp><![CDATA[=\s*new\s+array\s*\(\s*((\d{1,5}),){350}]]></regexp>
                <search target="method">
                    <match>eval</match>                    
                    <search target="object">
                        <match>window</match>
                    </search>
                    <search target="param">
                        <match>document.createelement(</match>
                    </search>
                </search>
            </search>
			<search target="script" encryptedDegree="1">
				<search target="method">
					<match>createelement</match>
					<search target="param">
                        <match>iframe</match>
					</search>
				</search>
			</search>
		</rule>

		<rule name="JS.IframeHidden.GB" weight="0" feedback="1">
			<desp>General/hidden iframe</desp>
			<search target="script" encryptedDegree="1">
				<search target="method">
					<match>createelement</match>
					<search target="param">
                        <match>iframe</match>
					</search>
				</search>
				<search target="method">
					<match>appendchild(iframe)</match>
					<search target="param">
                        <pre-match>px</pre-match>
                        <regexp><![CDATA[[^a-zA-Z0-9-_](left|top): *-?\d{4,}px]]></regexp>
					</search>
				</search>
			</search>
		</rule>		

		<rule name="JS.IframeHidden.GC" weight="0" feedback="1">
			<desp>General/hidden iframe</desp>
			<search target="script" encryptedDegree="1">
				<search target="method">
					<match>createelement</match>
					<search target="param">
                        <match>iframe</match>
					</search>
				</search>
				<search target="method">
					<match>appendchild(iframe)</match>
					<search target="param">
                        <pre-match>px</pre-match>
                        <regexp><![CDATA[[^a-zA-Z0-9-_](height|width): *\d{4,}px]]></regexp>
					</search>
				</search>
			</search>
		</rule>		

		<rule name="JS.IframeHidden.GD" weight="0" feedback="1">
			<desp>General/hidden iframe</desp>
			<search target="script" encryptedDegree="1">
				<search target="method">
					<match>createelement</match>
					<search target="param">
                        <match>iframe</match>
					</search>
				</search>
				<search target="method">
					<match>appendchild(iframe)</match>
					<search target="param">
                        <match>position: 293</match>
					</search>
				</search>
			</search>
		</rule>		

		<rule name="JS.IframeHidden.GE" weight="0" feedback="1">
			<desp>General/hidden iframe</desp>
			<search target="script">
				<search target="method">
					<match>createelement</match>
					<search target="param">
                        <match>iframe</match>
					</search>
				</search>
				<search target="method">
					<match>write</match>
					<search target="object">
                        <match>document</match>
					</search>
					<search target="param">
                        <pre-match>class</pre-match>
                        <regexp><![CDATA[<p *id=\S* *class=\S* *><\/p>]]></regexp>
					</search>
				</search>
				<search target="method">
					<match>appendchild(iframe)</match>
					<search target="param">
                        <match>position: 293</match>
					</search>
				</search>
			</search>
		</rule>		

		<rule name="JS.IframeHidden.GF" weight="0" feedback="1">
			<desp>General/hidden iframe</desp>
			<search target="script" encryptedDegree="1">
                <pre-match>onload</pre-match>
                <regexp><![CDATA[window\.onload *= *[a-zA-Z0-9_]+]]></regexp>
			</search>
			<search target="script">
                <match>window.onload()</match>
				<search target="method">
					<match>createelement</match>
					<search target="param">
                        <match>iframe</match>
					</search>
				</search>
				<search target="method">
					<match>appendchild(iframe)</match>
					<search target="param">
                        <match>position: 293</match>
					</search>
				</search>
			</search>
		</rule>		

		<rule name="JS.IframeHidden.H" weight="0" feedback="1">
			<desp>General/hidden iframe</desp>
			<search target="script" encryptedDegree="1">
				<search target="method">
					<match>write</match>
					<search target="object">
                        <match>document</match>
					</search>
					<search target="param">
                        <pre-match>iframe</pre-match>
                        <regexp><![CDATA[<iframe [\s\S]{1,200}[^a-zA-Z0-9-_](height|width): *\dpx]]></regexp>
					</search>
				</search>
			</search>
		</rule>		
						   
        <rule name="JS.PackerEncrypt.B" weight="0" feedback="1">
            <search target="script">
                <match><![CDATA[$]]></match>
                <!--
                    match text like:
                        $$_._$$..._$.$$$...$$$.___...
                        That is to say, all variables are named by '$' and '_'
                -->
                <regexp><![CDATA[([\$_]{1,5}\.[\$_]{1,5}[^\$a-zA-Z0-9]{1,20}){400}]]></regexp>
            </search>
        </rule>
        
        <rule name="JS.PackerEncrypt.C" weight="0" feedback="1">
            <search target="script">
                <match>unescape</match>
                <match>eval</match>
                <regexp><![CDATA[[\w]{1,15}\s*=\s*('|")[0-9a-z]{1000}]]></regexp>
                <!--
                    match text like:
                        try{KRmdxd3('Syxj4();')}catch(e) {try{OMXHGgD8=GTSXAv0;KRmdxd3('Syxj4();');}catch(
                -->
               <regexp><![CDATA[try\s*\{\s*([\w]{1,15})\(['"]([\w]{1,15})\(\)[\s;]*['"]\)[\s;]*\}\s*catch\([\w]{1,15}\)\s*\{\s*try\s*\{[\s\S]{1,150}\1\(['"]\2\(\)[\s;]*['"]\)[\s;]*\}\s*catch\(]]></regexp>
            </search>
        </rule>

		<rule name="JS.FakeAlert.A" weight="10" feedback="1">
   			<search target="method">
				<search target="param">
					<pre-match>infected</pre-match>
					<regexp>your\s*computer\s*remains\s*infected\s*by\s*viruses</regexp>
				</search>
			</search>
		</rule>
   	
		<rule name="JS.FakeAlert.B" weight="10" feedback="1">
   			<search target="script">
				<pre-match>infected</pre-match>
				<regexp>your\s*computer\s*remains\s*infected\s*by\s*viruses</regexp>
			</search>
		</rule>
   	
		<rule name="JS.FakeAlert.C" weight="10" feedback="1">
			<search target="script">
				<pre-match>infected</pre-match>
				<regexp>your\s*computer\s*is\s*infected\s*by\s*malicious</regexp>
			</search>
		</rule>
				
		<rule name="JS.FakeAlert.D" weight="0" feedback="1">
			<search target="script">
				<pre-match>detected</pre-match>
				<regexp>your\s*computer\s*detected[\s\S]{0,50}(malicious|suspicious)[\s\S]{1,200}(antivirus|antispyware)</regexp>
			</search>
		</rule>
        
        <rule name="JS.FakeAlert.E" weight="0" feedback="1">
            <search target="script">
                <match>.fromcharcode</match>
                <!--
                    match text like:
                        res = "";
                        for (var jok = 1; jok < sdf.length; jok++){
                            eval('pj_hok = sdf.charCodeAt(jok) ^sdf.charCodeAt(jok-1);');
                            tmp1 = String.fromCharCode(pj_hok);
                            res+= tmp1;     	
                        }
                        return res
                --> <regexp><![CDATA[([\w]{1,10})\s*=\s*('|")\2[;\s]*for\s*\((var)?\s*([\w]{1,10})\s*=[\s\S]{1,100}\.charcodeat\(\4\)\s*\^\s*[\w]{1,10}\.charcodeat\(\4[\s\S]{1,80}\1\s*\+=[\s\S]{1,50}return\s+\1]]></regexp>
                <!--
                    match text like:
                        phills="dEhpLWIhdSx8ORlxBWgEJHQhYy9mJQ...sdfeFEDSDfe...
                -->
                <regexp><![CDATA[[\w]{1,15}\s*=\s*['"][\w+/]{1000}]]></regexp>
            </search>
        </rule>

		<rule name="JS.FSOModify.A" weight="0" feedback="1">
			<search target="method">
				<search target="object">
					<pre-match>filesystemobject</pre-match>
					<pre-match>document.object['msmedia']</pre-match>
				</search>
				<pre-match>deletefile</pre-match>
				<pre-match>deletefolder</pre-match>
				<pre-match>createtextfile</pre-match>
				<pre-match>writeline</pre-match>
				<pre-match>write</pre-match>
				<pre-match>writeblanklines</pre-match>
				<pre-match>createfolder</pre-match>
				<pre-match>copyfile</pre-match>
				<pre-match>movefile</pre-match>	 
			</search>
		</rule>
		
		<rule name="JS.FSOModify.B" weight="0" feedback="1">
			<search target="method">
				<pre-match>specialfolders</pre-match>
				<search target="param">
					<pre-match>allusersdesktop</pre-match>
				</search>
			</search>
			<search target="method">
				<pre-match>createtextfile</pre-match>
				<pre-match>createfolder</pre-match>
				<search target="object">
					<pre-match>filesystemobject</pre-match>
				</search>
			</search>
			<search target="method">
				<pre-match>write</pre-match>
				<search target="object">
					<pre-match>createtextfile</pre-match>
					<search target="param">
						<pre-match>=unescape(</pre-match>
					</search>
				</search>
			</search>
		</rule>

		<rule name="JS.FSOStartUp.A" weight="10" feedback="1">		
			<search target="method">
				<search target="param">
					<pre-match>startup</pre-match>
					<regexp><![CDATA[start menu[\/|\\|\s]{0,1}programs[\/|\\|\s]{0,1}startup[\/|\\|\s]{0,1}[\S]{1,255}.exe]]></regexp>
				</search>
			</search>	
		</rule>

		<rule name="JS.ObjLoadBinary.A" weight="10" feedback="1">
			<search target="script" encryptedDegree="1">
				<search target="method">
					<search target="param">
						<pre-match>c1b7e532-3ecb-4e9e-bb3a-2951ffe67c61</pre-match>
						<regexp>param\s*name=\s*('|")\s*propdownloadurl\s*('|")\s*value\s*=\s*('[^\']{1,1000}|"[^\"]{1,1000})\.exe</regexp>
					</search>
				</search>
			</search>
		</rule>
		
		<rule name="JS.Iframer.A" weight="20">
			<search target="script" encryptedDegree="1">
				<search target="method">
					<pre-match>eval</pre-match>
					<search target="object">
						<match>window</match>
					</search>
					<search target="param">
						<regexp><![CDATA[document\.getelementsbytagname[\s\S]{1,500}<iframe[^<>]*(width|height)\s*=\s*('|"){0,1}[1-2]?[0-9]\W('|"){0,1}[\s\S]{0,50}visibility:hidden]]></regexp>
					</search>
				</search>
			</search>
		</rule>
		
		<rule name="JS.JsGenerateApplet.A" weight="20">
			<search target="script">
				<search target="method">
					<pre-match>createelement</pre-match>
					<search target="object">
						<match>document</match>
					</search>
					<search target="param">
						<regexp><![CDATA[applet]]></regexp>
					</search>
				</search>		
				<search target="method">
					<pre-match>setattribute</pre-match>
					<search target="object">
						<match>document.applet</match>
					</search>
					<search target="param">					
						<regexp><![CDATA[archive]]></regexp>
					</search>	
					<search target="param">					
						<regexp><![CDATA[http:\/\/]]></regexp>
					</search>				
				</search>
				<search target="method">
					<pre-match>setattribute</pre-match>
					<search target="object">
						<match>document.applet</match>
					</search>
					<search target="param">					
						<regexp><![CDATA[(width|height)]]></regexp>
					</search>	
					<search target="param">					
						<pre-match>0</pre-match>
						<pre-match>1</pre-match>
						<pre-match>2</pre-match>
						<pre-match>3</pre-match>
					</search>				
				</search>
			</search>
		</rule>	

		<rule name="JS.JsGenerateApplet.B" weight="0" feedback="1">
			<search target="method">
				<pre-match>write</pre-match>
				<pre-match>eval</pre-match>
				<search target="object">
					<pre-match>document</pre-match>
					<pre-match>window</pre-match>
				</search>
				<search target="param">
					<regexp><![CDATA[<applet[^><]*(code\s*=\s*[^><]{1,30}\.class[^><]*(width|height)\s*=\s*\W('|"){0,1}[0-9]\W('|"){0,1}|(width|height)\s*=\s*\W('|"){0,1}[0-9]\W('|"){0,1}[^><]*code\s*=\s*[^><]{1,30}\.class)]]></regexp>					   
				</search>
			</search>
		</rule>

		<rule name="JS.KaixinDecoder.A" weight="0" feedback="1">
			<search target="script">
				<pre-match>kaixindecode</pre-match>
				<regexp>('|")[^\'\"]{3000,}\1[\s\S]{1,200}(while|for)[\s\S]{1,200}\.charcodeat\([\s\S]{1,500}kaixindecode</regexp>
			</search>
		</rule>	

		<rule name="JS.CrimeBoss.A" weight="0" feedback="1">
			<search target="script">
				<match>jsm_lab_on</match>
				<match>jsm_labreport2</match>
				<match>jsm_createimg</match>
				<match>jsm_getappleturl</match>
				<match>jsm_oncreate</match>
			</search>
		</rule>
		
		<rule name="JS.LandingByTryCatch.A" weight="0" feedback="1">
			<search target="script" encryptedDegree="1">
				<match>try</match>
				<match>catch</match>
				<search target="method">
					<pre-match>eval</pre-match>
					<search target="object">
						<match>window</match>
					</search>
					<search target="param">
						<regexp><![CDATA[document\.location\s*=\s*("|')http]]></regexp>
					</search>
				</search>
			</search>
		</rule>

		<rule name="JS.HeapLib.A" weight="20">
			<search target="script" encryptedDegree="1">
				<match>heaplib</match>   
			</search>
		</rule> 

		<rule name="JS.Xiaomaolv.A" weight="0" feedback="1">
		    <search target="script">
		        <pre-match>xiaomaolv</pre-match>
				<match>woyouyizhixiaomaolv</match>
				<match>conglaiyebuqi</match>
		    </search>
		</rule>

		<rule name="JS.MitB.A" weight="0" feedback="1">
		    <desp>Man in the Browser</desp>
		    <search target="method">
		        <pre-match>write</pre-match>
				<search target="object">
					<match>document</match>
				</search>
				<search target="param">
				    <pre-match>credit</pre-match>
				    <pre-match>security</pre-match>
				    <pre-match>master card</pre-match>
				    <pre-match>visa</pre-match>
					<regexp><![CDATA[verify\s*your\s*identity\s*with\s*[a]?\s*credit[\s\S]{0,15}card]]></regexp>
				</search>
			</search>	
		</rule>

		<rule name="JS.MitB.B" weight="0" feedback="1">
		    <desp>Man in the Browser</desp>
		    <search target="method">
		        <pre-match>eval</pre-match>
				<search target="object">
					<match>window</match>
				</search>
				<search target="param">
				    <pre-match>credit</pre-match>
				    <pre-match>security</pre-match>
				    <pre-match>master card</pre-match>
				    <pre-match>visa</pre-match>
					<regexp><![CDATA[need\s*to\s*verify\s*your\s*identity\s*with\s*[a]?\s*credit\s*or\s*debit\s*card]]></regexp>
				</search>
			</search>	
		</rule>

		<rule name="JS.MitB.C" weight="0" feedback="1">
		    <desp>Man in the Browser</desp>
		    <search target="method">
		        <pre-match>write</pre-match>
				<search target="object">
					<match>document</match>
				</search>
				<search target="param">
				    <pre-match>cardholder</pre-match>
				    <pre-match>security code</pre-match>
				    <pre-match>master card</pre-match>
				    <pre-match>visa</pre-match>
				    <pre-match>digits on the back of a card</pre-match>
					<regexp><![CDATA[last[\s\S]{0,10}digits[\s\S]{0,10}bank[\s\S]{0,10}account[\s\S]{0,10}number]]></regexp>
				</search>
			</search>	
		</rule>

		<rule name="JS.MitB.D" weight="0" feedback="1">
		    <desp>Man in the Browser</desp>
			<search target="method">
				<pre-match>eval</pre-match>
				<search target="object">
					<match>window</match>
				</search>
				<search target="param">
				    <pre-match>cardholder</pre-match>
				    <pre-match>security code</pre-match>
				    <pre-match>master card</pre-match>
				    <pre-match>visa</pre-match>
				    <pre-match>digits on the back of a card</pre-match>
					<regexp><![CDATA[last[\s\S]{0,10}digits[\s\S]{0,10}bank[\s\S]{0,10}account[\s\S]{0,10}number]]></regexp>
				</search>
			</search>
		</rule>

		<rule name="JS.MitB.E" weight="0" feedback="1">
		    <desp>Man in the Browser</desp>
		    <search target="script">
		        <pre-match>bank</pre-match>
		        <pre-match>visa</pre-match>
		        <pre-match>mastercard</pre-match>
		        <pre-match>master card</pre-match>
		        <match>setopacity</match>
		        <match>password</match>
		        <match>securecode</match>
		        <match>digit</match>
		        <match>back</match>
		        <match>cardholder</match>
		        <match>birth</match>
		        <match>expir</match>
			</search>	
		</rule>

		<rule name="JS.CVE-2013-1347" weight="20">
		    <search target="script">
			    <pre-match>collectgarbage</pre-match>
			    <pre-match>offsetparent</pre-match>
			    <pre-match>innerhtml</pre-match>
			    <regexp>\.offsetparent[\s\S]{0,10}=[\s\S]{0,10}null[\s\S]{0,200}\.innerhtml[\s\S]{0,10}=[\s\S]{0,10}\"\"[\s\S]{0,200}\.appendchild</regexp>
		    </search>	
		</rule>

		<rule name="JS.CVE-2013-3918" weight="0" feedback="1">
		    <search target="script">
			    <pre-match>requiredclaims</pre-match>
                <regexp>(set|var)\s+([a-z0-9_])+\s=[\s\S]{1,50}\.requiredclaims[\s\S]{0,300}\2\.remove\([\s\S]{1,300}\2\.add\(</regexp>
		    </search>	
		</rule>

		<rule name="JS.GenericCK.A" weight="0" feedback="1">
			<desp>Generic rule to souring CK</desp> 
				<search target="method">
					<pre-match>eval</pre-match>
					<search target="object">
						<match>window</match>
					</search>
					<search target="param">
						<match>initscript</match>
						<match>initobj</match>
						<regexp><![CDATA[version[\s\S]{0,5}:[\s\S]{0,20}\"\d\.\d\.\d\"[\s\S]{0,1000}isdefined[\s\S]{0,1000}isarray[\s\S]{0,1000}isnum]]></regexp>
					</search>
				</search>
		</rule>

		<rule name="JS.HeapSpray.A" weight="10" feedback="1">
			<desp>Generic rule to detect Heap Spray</desp>
			
			<search target="script">
				<pre-match>createelement</pre-match>
				<regexp><![CDATA[for\s*\([\s\S]{5,50}\)\s*\{[\s\S]{5,50}=\s*[\s\S]{1,50}\.createelement\([\s\S]{1,20}\)[\s\S]{1,50}\.(classname|title|value)\s*=\s*[^}]{1,150}\}]]></regexp>
			</search>
		</rule>

		<rule name="JS.HeapSpray.B" weight="10" feedback="1">
			<desp>Generic rule to detect Heap Spray</desp>
			
			<search target="script">
				<pre-match>createelement</pre-match>
				<match>collectgarbage</match>
				<regexp><![CDATA[for\s*\([\s\S]{5,50}\)\s*\{[\s\S]{5,50}[\(=]\s*[\s\S]{1,50}\.createelement\([\s\S]{1,20}\)[\s\S]{1,20}[^}]{1,150}\}]]></regexp>
			</search>
		</rule>

		<rule name="JS.HeapSpray.C" weight="20">
			<desp>Generic rule to detect Heap Spray for VBS</desp>
			
			<search target="script">
				<pre-match>createelement</pre-match>
				<regexp><![CDATA[for\s+[\s\S]{1,40}\s*=\s*[\s\S]{1,40}\s*to\s*[\s\S]{1,40}\s*set\s*[\s\S]{1,40}\s*=\s*[\s\S]{1,50}\.createelement\([\s\S]{1,20}\)]]></regexp>
			</search>
		</rule>

		<rule name="JS.ROP.A" weight="20">
			<desp>Generic rule to detect ROP</desp>
			
			<search target="method">
				<pre-match>unescape</pre-match>
				<search target="param">
					<pre-match>%ud801%u77c4</pre-match>
				</search>
			</search>
		</rule>

		<rule name="JS.ROP.B" weight="20">
			<desp>Generic rule to detect ROP</desp>
			
			<search target="method">
				<pre-match>unescape</pre-match>
				<search target="param">
					<pre-match>%u45f8%u7c34</pre-match>
				</search>
			</search>
		</rule>

		<rule name="JS.ROP.C" weight="20">
			<desp>Generic rule to detect ROP</desp>
			
			<search target="method">
				<pre-match>unescape</pre-match>
				<search target="param">
					<pre-match>%ud801%u77bf</pre-match>
				</search>
			</search>
		</rule>


	</rule-set>

	<rule-set category="Specific">

		<rule name="JS.Redir.D" weight="0" feedback="1">
	  	  <search target="script">
	  	    <match>string.fromcharcode</match>
	  	    <match>php_session_id</match>
		    <regexp><![CDATA[([\d]{1,3}\|){150}]]></regexp>
	  	  </search>
		</rule>
        
		<rule name="JS.Redir.E" weight="0" feedback="1">
            <search target="script">
                <match>o1,o2,o3,h1,h2,h3,h4,bits,</match>
                <regexp><![CDATA[=['"][0-9a-zA-Z]{600,1200}['"]]]></regexp>
                <regexp><![CDATA[eval\([0-9a-zA-Z_]{1,10}\([0-9a-zA-Z_]{1,10}\([0-9a-zA-Z_]{1,10}\)\)\)]]></regexp>
            </search>
            <search target="script">
                <search target="method">
                    <match>setattribute</match>
                    <search target="object">
                        <match>document.script</match>
                    </search>
                    <search target="param">
                        <match>api.myobfuscate.com</match>
                    </search>
                </search>
            </search>
		</rule>
        
        <rule name="JS.Redir.F" weight="0" feedback="1">
            <search target="script">
                <match>df</match>
                <regexp><![CDATA[df\(['"][^'"]{150}]]></regexp>
                <search target="method">
                    <match>write</match>
                    <search target="object">
                        <match>document</match>
                    </search>
                    <search target="param">
                        <regexp><![CDATA[<script[\s\S]{10,40}function\s+df\(]]></regexp>
                    </search>
                </search>
            </search>
        </rule>
        
        <rule name="JS.Redir.G" weight="0" feedback="1">
            <search target="script">
                <match>function decrypt_p(</match>
                <regexp><![CDATA[decrypt_p\(['"][^\s]{120,500}['"]\)]]></regexp>
                <search target="method">
                    <match>write</match>
                    <search target="object">
                        <match>document</match>
                    </search>
                    <search target="param">
                        <match><![CDATA[<iframe]]></match>
                    </search>
                </search>
            </search>
        </rule>
        
        <rule name="JS.Redir.H" weight="0" feedback="1">
            <search target="script">
                <search target="method">
                    <match>write</match>
                    <search target="object">
                        <match>document</match>
                    </search>
                    <search target="param">
                        <regexp><![CDATA[function\s+\w{1,10}\(\w{1,10}\)\s*\{\s*return\s+\w{1,10};?\s*\}\s*try\s*\{\s*function\s+(\w{1,10})\(\w{1,10}\)\s*\{\s*return\s+parseint\(\w{1,10}\);?\s*\}[\s\S]{0,300}(\1\(['"]\d{1,5}['"]\),(\d{1,8}\^\d{1,8},){0,8}){20}]]></regexp>
                    </search>
                </search>
            </search>
        </rule>

        <rule name="JS.Redir.I" weight="0" feedback="1">
            <search target="script">
                <match>h=-012/5</match>
                <match>try{prototype-1;</match>
                <regexp><![CDATA[(\d{1,5},){100}]]></regexp>
                <search target="method">
                    <match>eval</match>
                    <search target="object">
                        <match>window</match>
                    </search>
                    <search target="param">
                        <regexp><![CDATA[document.write\(['"]<iframe]]></regexp>
                    </search>
                </search>
            </search>
        </rule>
        
        <rule name="JS.Redir.IA" weight="0" feedback="1">
            <search target="script">
                <match>h=-parseint('012')/5</match>
                <match>document.getelementbyid("qwe")</match>
                <regexp><![CDATA[\w{1,10}\s*=\s*['"](\d+?\.?\d+?~){300}]]></regexp>
            </search>
        </rule>
        
        <rule name="JS.Redir.J" weight="0" feedback="1">
            <search target="script">
                <match>eval</match>
                <regexp><![CDATA[\w{1,10}\s*=(\s*\w{1,10}<<\d{1,3}\s*\|?){1,5}\w{1,10}[\s;]*\w{1,10}\s*=\w{1,10}>>\d{1,3}&0x]]></regexp>
            </search>
            <search target="script">
                <match>%</match>
                <regexp><![CDATA[(%u\w{1,5}){80}]]></regexp>
                <search target="method">
                    <match>write</match>
                    <search target="object">
                        <match>document</match>
                    </search>
                    <search target="param">
                        <match><![CDATA[<iframe]]></match>
                    </search>
                </search>
            </search>
        </rule>

        <rule name="JS.Redir.K" weight="0" feedback="1">
            <search target="script">
                <pre-match>array</pre-match>
                <pre-match>string</pre-match>
                <pre-match>date</pre-match>
                <regexp><![CDATA[(\w{1,3}\s*=\s*('|")\2[\s;]+[\s\S]{0,300}?){6}]]></regexp>
                <regexp><![CDATA[(var\s+\w{1,10}\s*=\s*new\s+(string|array|date|regexp)[\s\S]{0,300}?){8}]]></regexp>
            </search>
            <search target="script">
                <search target="method">
                    <match>setattribute</match>
                    <search target="object">
                        <match>document.script</match>
                    </search>
                </search>
            </search>
        </rule>
        
        <rule name="JS.Redir.N" weight="0" feedback="1">
            <search target="script">
                <match>document</match>
                <regexp><![CDATA[([^a-zA-Z0-9/%#](iii|iil|ii1|ili|ill|il1|i1i|i1l|i11|lii|lil|li1|lli|lll|ll1|l1i|l1l|l11)\W[\s\S]{0,100}?){14}]]></regexp>
            </search>
        </rule>
        
		<rule name="JS.UnknownEK_FDash.A" weight="0" feedback="1">
	  		<search target="script" encryptedDegree="4">
	  			<match>settimeout</match>
	  			<match>eval</match>
                <regexp><![CDATA[([a-zA-Z0-9]{20,30}:[^,]+,\s*){100}]]></regexp>
	  		</search>
		</rule>
        
		<rule name="JS.UnknownEK_jQuery.A" weight="0" feedback="1">
	  		<search target="script" encryptedDegree="4">
	  			<match>|enc3</match>
	  			<match>|enc2</match>
	  			<match>|enc4</match>
	  			<match>|function</match>
                <regexp><![CDATA[eval\(function\(\w+,\w+,\w+,\w+,\w+,\w+\)\{]]></regexp>
	  		</search>
		</rule>
        
        <rule name="JS.UnknownEK.B" weight="0" feedback="1">
            <search target="script">
                <match>function</match>
                <regexp><![CDATA[['"][0-9a-zA-Z]{1000}]]></regexp>
                <!--
                    match text like:
                        function m(){....{1,500}
                        m("asdf")...m("hjkl")...m("qwer")...{10}
                -->
                <regexp><![CDATA[function\s+(\w{1,10})\s*\(.{1,10}\)\s*\{[\s\S]{1,500}(=\s*\1\s*\(['"]\w{3,}['"]\s*\)[;\s\w]{1,50}){10}]]></regexp>
            </search>
        </rule>
        
        <rule name="JS.UnknownEK.C" weight="0" feedback="1">
            <search target="script">
                <match>document.write(unescape</match>
                <regexp><![CDATA[(document\.write\(unescape\([\s\S]{1,200}){8}]]></regexp>
                <search target="method">
                    <match>write</match>
                    <search target="object">
                        <match>document</match>
                    </search>
                    <search target="param">
                        <match><![CDATA[<object]]></match>
                    </search>
                </search>
            </search>
        </rule>
        
        <rule name="JS.UnknownEK.FA" weight="0" feedback="1">
            <search target="script">
                <match>applet</match>
                <search target="method">
                    <match>write</match>
                    <search target="object">
                        <match>document</match>
                    </search>
                    <search target="param">
                        <regexp><![CDATA[value\s*=\s*('|")[0-9a-z\+]{1500}]]></regexp>
                    </search>
                </search>
            </search>
        </rule>
        
		<rule name="JS.CVE-2013-3893.A" weight="20">
			<search target="script">
				<pre-match>onlosecapture</pre-match>
				<match>setcapture</match>
				<regexp><![CDATA[\.applyelement\([\s\S]{1,200}\.onlosecapture\s*=\s*[\s\S]{1,500}outertext[\s\S]{1,200}\.setcapture]]></regexp>
			</search>
		</rule>

		<rule name="JS.CVE-2013-3918" weight="0" feedback="1">
		    <search target="script">
			    <pre-match>requiredclaims</pre-match>
                <regexp>(set|var)\s+([a-z0-9_])+\s=[\s\S]{1,50}\.requiredclaims[\s\S]{0,300}\2\.remove\([\s\S]{1,300}\2\.add\(</regexp>
		    </search>	
		</rule>
		


		<rule name="JS.CVE-2006-0003.A" weight="0" feedback="1">
	  		<search target="method">
	  			<pre-match>savetofile</pre-match>
				<pre-match>shellexecute</pre-match>
	  		</search>
		</rule>

		<rule name="JS.CVE-2006-0003.B" weight="0" feedback="1">
	  		<search target="script" encryptedDegree="1">
	  			<search target="script">
					<pre-match>adodb.stream</pre-match>
					<pre-match>wscript.shell</pre-match>
					<pre-match>bd96c556-65a3-11d0-983a-00c04fc29e36</pre-match>
				</search>
	  		</search>
		</rule>

		<rule name="JS.CVE-2006-1016.A" weight="20">
			<search target="method">
				<pre-match>isComponentInstalled</pre-match>
				<search target="param">
					<regexp>\w{256,}</regexp>
				</search>
				<search target="param">
					<match>componentid</match>
				</search>
			</search>
		</rule>

		<rule name="JS.CVE-2011-0026.A" weight="20">
			<search target="method">
				<pre-match>recordset</pre-match>
				<search target="object">
					<match>htmlxmlelement</match>
				</search>			
			</search>
			<search target="method">
				<pre-match>cachesize</pre-match>
				<search target="object">
					<match>htmlxmlelement</match>
				</search> 
				<search target="param">
					<regexp>\w{10,}</regexp>
				</search>   		
			</search>
		</rule>

		<rule name="JS.Webhmi.A" weight="20">
	  		<search target="method">
				<search target="param">
					<pre-match>clsid:d25fcafc-f795-4609-89bb-5f78b4acaf2c</pre-match>
				</search>
			</search>
	  		<search target="method">
	  			<pre-match>setactivexguid</pre-match>
				<search target="param">
					<regexp>.{300,}</regexp>
				</search>
	  		</search>
		</rule>

		<rule name="JS.CVE-2007-5601.A" weight="10" feedback="1">
	  		<search target="script">
				<pre-match>llll\\xxxxxld</pre-match>
			  	<match>.import</match>
	  		</search>
		</rule>	  
   
		<rule name="JS.CVE-2008-2463.A" weight="20">
			<desp>MS08-041</desp>
			<search target = "param">
	  			<pre-match>f0e42d50-368c-11d0-ad81-00a0c90dc8d9</pre-match>
	  		</search>
	  		<search target="method">
				<pre-match>printsnapshot</pre-match>
				<search target="param">
					<match>http://</match>
				</search>
	  		</search>
		</rule>
	  
		<rule name="JS.CVE-2008-2463.B" weight="20">
	  		<desp>MS08-041</desp>
	  		<search target="method">
	  			<search target="object">
					<pre-match>snpvw.snapshot</pre-match>
				</search>
				<search target="param">
					<match>http://</match>
			 	</search>
			</search>
	  		<search target="method">
	  			<match>printsnapshot</match>
	  		</search>
		</rule>	  
	  
		<rule name="JAVA.CVE-2010-1423.A" weight="20">
	  		<desp>Java NPAPI plugin exploit</desp>
	  		<search target="method">
	  			<search target="param">
					<pre-match>cafeefac-dec7-0000-0000-abcdeffedcba</pre-match>
				</search>
	  		</search>
	  		<search target="method">
	  			<search target="param">
					<regexp>http: -j-xxaltjvm.*\.jnlp|[\s\S]{0,10}-j[\s\S]{0,10}-jar[\s\S]{0,10}-j[\s\S]{1,300}none[\s\S]{0,10}</regexp>
				</search>
	  		</search>
		</rule>
	  
		<rule name="JAVA.CVE-2010-1423.B" weight="20">
	  		<desp>Java NPAPI plugin exploit</desp>
	  		<search target="method">
	  			<match>createelement</match>
				<search target="param">
					<match>object</match>
				</search>
	  		</search>
	  		<search target="method">
	  			<match>launch</match>
				<search target="object">
					<match>document.object</match>
				</search>
				<search target="param">
					<regexp>http: -j-xxaltjvm.*\.jnlp|[\s\S]{0,10}-j[\s\S]{0,10}-jar[\s\S]{0,10}-j[\s\S]{1,300}none[\s\S]{0,10}</regexp>
				</search>
			</search>
		</rule>
	  
		<rule name="JS.CVE-2009-1534.A" weight="20">
			<search target="script" encryptedDegree="1">
				<pre-match>.htmlurl</pre-match>
				<regexp>\.htmlurl\s*=\s*unescape\(.{9000,}\)</regexp>  
			</search> 
			<search target="script">
				<search target="method">
					<search target="param">
						<pre-match>0002e510-0000-0000-c000-000000000046</pre-match>
						<pre-match>0002e511-0000-0000-c000-000000000046</pre-match>
						<pre-match>0002e512-0000-0000-c000-000000000046</pre-match>
					</search>
				</search>
			</search>
		</rule>
	 
		<rule name="JS.CVE-2010-0806.A" weight="20">
	   		<search target="script">
				<pre-match>.addbehavior</pre-match>
				<match>.setattribute</match>
				<regexp>document\.createelement\(.+\)[\s\S]{1,100}\.addbehavior\(.+\)[\s\S]{1,400}\.setattribute[\s\S]{1,500}window\.status</regexp>
			</search>
		</rule>
	  
		<rule name="JS.CVE-2010-0806.B" weight="0" feedback="1">
	   		<search target="script">
				<pre-match>.addbehavior</pre-match>
				<match>.setattribute</match>
				<regexp>document(\["\\x63reateelement"\]|\["createelement"\])\(.+\)[\s\S]{1,100}\.addbehavior\(.+\)[\s\S]{1,400}\.setattribute[\s\S]{1,500}window\.status</regexp>
			</search>
		</rule>
	  
		<rule name="JS.MS06-013.A" weight="20">
	  		<search target="script">
				<pre-match>createtextrange</pre-match>
				<match>.getelementbyid</match>
				<match>unescape</match>
				<regexp>(^|\s)(\S{1,20})\s*=\s*unescape\([\s\S]{10,300}(for|while)[\s\S]{10,300}(=|\+)\s*\2[\s\S]{10,300}document\.getelementbyid\([^(|^)]+\)\.createtextrange\(\s*\)</regexp>
			</search>
		</rule>
	  
		<rule name="JS.MS09_002.A" weight="0" feedback="1">
			<search target="script">
				<pre-match>clonenode</pre-match>
				<match>.click</match>
				<regexp>(\w{1,50})\s{0,20}=\s{0,20}document.createelement.{1,200}(\w{1,20})\s{0,20}=\s{0,20}\1\.clonenode\(\).{1,200}\2\.click</regexp>
			</search>
		</rule>

		<rule name="JS.NIMDA.A" weight="10" feedback="1">
			<search target="script">
				<pre-match>.eml</pre-match>
				<regexp><![CDATA[top\s*=\s*[0-9]*[1-9][0-9]{3,}[\s\S]{1,5}left\s*=\s*[0-9]*[1-9][0-9]{3,}]]></regexp>
				<search target="method">
					<match>open</match>
					<search target="object">
						<match>window</match>
					</search>
				</search>
			</search>
		</rule>
		
		<rule name="JS.GENERIC.Z" weight="0" feedback="1">
			<search target="All">
				<pre-match>0d43fe01-f093-11cf-8940-00a0c9054228</pre-match>
				<match>f935dc22-1cf0-11d0-adb9-00c04fd58a0b</match>
			</search>
		</rule>
		
		<rule name="JS.GENERIC.A" weight="0" feedback="1">
			<search target="method">
				<pre-match>eval</pre-match>
				<search target="object">
					<match>window</match>
				</search>
				<search target="param">
					<regexp><![CDATA[eval\(unescape\([\w]{1,20}.replace\(]]></regexp>
				</search>
			</search>
		</rule>

		<rule name="JAVA.CVE-2010-4452.A" weight="20">
			<search target="method">
				<search target="param">
					<pre-match>java\jre6\lib\ext</pre-match>
					<regexp><![CDATA[file:[^\n]*java\\jre6\\lib\\ext]]></regexp>
				</search>
			</search>
		</rule>
		
		<rule name="JS.CVE-2010-1885.A" weight="20">
			<search target="script">
				<pre-match>6bf52a52-394a-11d3-b153-00c04f79faa6</pre-match>
				<search target="method">
					<pre-match>setattribute</pre-match>
					<search target="param">
						<pre-match>uimode</pre-match>
						<pre-match>invisible</pre-match>
					</search> 
				</search>  	
				<search target="method">
					<pre-match>openplayer</pre-match>
					<search target="param">
						 <match>http</match>
					</search> 
				</search>  				
			</search>
		</rule>
		
		<rule name="JS.CVE-2010-1885.B" weight="20">
			<search target="method">
				<search target="param">
					<pre-match>hcp://</pre-match>
					<regexp><![CDATA[hcp:\/\/system\/sysinfo\/sysinfomain.htm.{0,1000}script.{0,10}defer]]></regexp>
				</search>
			</search>
		</rule>

		<rule name="JS.CVE-2010-1885.D" weight="20">
			<search target="script">
				<pre-match>hcp://</pre-match>
				<match>hcp://system/sysinfo/sysinfomain.htm</match>
			</search>
		</rule>

		<rule name="JS.CVE-2011-2039.A" weight="20">
			<search target="script" encryptedDegree="1">
				<search target="method">
					<search target="param">
						<pre-match>55963676-2f5e-4baf-ac28-cf26aa587566</pre-match>
					</search>
				</search>
				<search target="method">
					<pre-match>setattribute</pre-match>
					<search target="param">
						<pre-match>url</pre-match>
						<regrex><![CDATA[http://]]></regrex>
					</search>
				</search>
			</search>
		</rule>
		
		<rule name="JS.CVE-2012-4787.A" weight="0" feedback="1">
			<search target="script">
				<pre-match>collectgarbage</pre-match>
				<regexp><![CDATA[lastchild\.style\.[\s\S]{1,200}collectgarbage\(\)[\s\S]{1,20}target\.outerhtml]]></regexp>
			</search>
		</rule>
		
		<rule name="JS.CVE-2009-0075.A" weight="10" feedback="1">
			<search target="all">
				<pre-match>collectgarbage</pre-match>
				<regexp><![CDATA[\.click[\s\S]{1,400}\.clonenode[\s\S]{1,400}\.clearattributes[\s\S]{1,400}=[\s]*null[\s\S]{1,100}collectgarbage[\s\S]{1,600}\.click]]></regexp>
			</search>
		</rule>
		
		<rule name="JS.CVE-2009-1136.A" weight="10" feedback="1">
			<search target="all">
				<pre-match>owc10.spreadsheet</pre-match>
				<pre-match>owc11.spreadsheet</pre-match>
				<match>evaluate</match>
				<regexp><![CDATA[\.push\(window\)[\s\S]{1,100}for[\s\S]{1,100}.evaluate\(]]></regexp>
			</search>
		</rule>
		
		<rule name="JS.CVE-2008-0624.A" weight="10" feedback="1">
			<search target="all">
				<pre-match>5f810afc-bb5f-4416-be63-e01dd117bd6c</pre-match>
			</search>
			<search target="method">
				<pre-match>addbutton</pre-match>
				<pre-match>addimage</pre-match>
				<search target="param">
					<regexp><![CDATA[http:\/\/[^\'\"]{256,}]]></regexp>
				</search>
			</search>
		</rule>
		
		<rule name="JS.CollectGarbage.A" weight="0"  feedback="1">
			
				<search target="method">
					<pre-match>eval</pre-match>
					<search target="object">
						<match>window</match>
					</search>
					<search target="param">
						<regexp><![CDATA[delete\s+[^\{\}]{1,30}try\s*\{\s*collectgarbage\(\)\s*;\s*\}]]></regexp>
					</search>
				</search>					 
			
		</rule>

		
		<rule name="JS.BlackholeKit.A" weight="20">
			<search target="all">
			  	<pre-match>javaversions</pre-match>
				<pre-match>adobereader</pre-match>
				<regexp><![CDATA[(function\s+spl\d[\s\S]{1,1000}){4,}]]></regexp>
			</search>
		</rule>
		
		<rule name="JS.BlackholeKit.B" weight="20">
			<search target="script" encryptedDegree="1">
				<search target="method">
					<pre-match>eval</pre-match>
					<search target="object">
						<match>window</match>
					</search>
					<search target="param">
						<match>plugindetect</match>
						<match>findnavplugin</match>
						<match>getmimeenabledplugin</match>
						<match>getpluginfileversion</match>
						<match>x-java-applet</match>
						<match>javaversions</match>
					</search>
				</search>
			</search>
		</rule>

		<rule name="JS.BlackholeKit.C" weight="0" feedback="1">
			<search target="all">
				<pre-match>parseint</pre-match>
				<regexp><![CDATA[while\s*\(\d{5,5}>\S\)\s*\{[^\}]{0,100}string(\['fromcharcod'\+'e'\]|\.fromcharcode)]]></regexp>
			</search>
		</rule>

		<rule name="JS.BlackholeKit.D" weight="0" feedback="1">
			
				<search target="method">
					<pre-match>eval</pre-match>
					<search target="object">
						<match>window</match>
					</search>
					<search target="param">
						<match>plugindetect</match>
						<match>findnavplugin</match>
						<match>getmimeenabledplugin</match>
						<match>getpluginfileversion</match>
					</search>
				</search>
			
		</rule>

		<rule name="JS.BlackholeKit.E" weight="0" feedback="1">
			<search target="all">
				<pre-match>javaversions</pre-match>
				<pre-match>adobereader</pre-match>
				<pre-match>plugindetect</pre-match>
				<regexp><![CDATA[(function\s+(spl|ns|ans)\d[\s\S]{1,1000}){3,}]]></regexp>
			</search>
		</rule>

		<rule name="JS.BlackholeKit.F" weight="20">
			<search target="script" encryptedDegree="1">
				<pre-match>javaversions</pre-match>
				<pre-match>adobereader</pre-match>
				<pre-match>plugindetect</pre-match>
				<match>getallocsize</match>
				<match>getfillbytes</match>
				<match>getshellcode</match>
			</search>
		</rule>

		<rule name="JS.BlackholeKit.G" weight="20">
			<search target="script" encryptedDegree="1">
				<pre-match>javaversions</pre-match>
				<pre-match>adobereader</pre-match>
				<pre-match>plugindetect</pre-match>
				<match>show_pdf</match>
				<match>end_redirect</match>
			</search>
		</rule>

		<rule name="JS.BlackholeKit.H" weight="20">
			<search target="script" encryptedDegree="1">
				<pre-match>javaversions</pre-match>
				<pre-match>adobereader</pre-match>
				<pre-match>plugindetect</pre-match>
				<match>check_win</match>
				<match>is_chrome</match>
			</search>
		</rule>

		<rule name="JS.BlackholeKit.I" weight="0" feedback="1">
			<desp>Source from Internal Benchmark Augest</desp>
			<search target="script" encryptedDegree="0">
				<pre-match>plugindetect</pre-match>
				<match>findnavplugin</match>
				<match>getmimeenabledplugin</match>
				<match>getpluginfileversion</match>
				<regexp>document\.createelement[\s\S]{1,100}setattribute[\s\S]{1,100}document\.body\.appendchild</regexp>
			</search>
		</rule>
		
		<rule name="JS.BlackholeKit.J" weight="0" feedback="1">
		   <search target="script">
			   <pre-match>plugins</pre-match>
			   <pre-match>mimetype</pre-match>
			   <pre-match>classid</pre-match>
			   <regexp><![CDATA[getversion[\s\S]{1,300}src=[\s\S]{1,50}\.pdf]]></regexp>
		   </search>
		</rule>
		
		<rule name="JS.BlackholeKit.K" weight="20">
		   <search target="script">
			   <pre-match>plugins</pre-match>
			   <pre-match>mimetype</pre-match>
			   <pre-match>classid</pre-match>
			   <regexp><![CDATA[settimeout\(pdf,\s*[0-9]{1,4}\)]]></regexp>
			   <regexp><![CDATA[function\s*pdf\(\)[\s\S]{1,300}pdfver(<|>|<=|>=|==)[\s\S][0-9]{1,5}]]></regexp>
		   </search>
		</rule>
		
		<rule name="JS.BlackholeKit.L" weight="20">
			<search target="method">
				<match>setattribute</match>
				<search target="object">
					<match>document.object</match>
				</search>
				<search target="param">
					<match>ca8a9780-280d-11cf-a24d-444553540000</match>
				</search>
			</search>
			<search target="method">
				<match>setattribute</match>
				<search target="object">
					<match>document.object</match>
				</search>
				<search target="param">
					<match>src</match>
				</search>
			</search>
		</rule>
        
        <rule name="JS.HelloEK.A" weight="0" feedback="1">
            <search target="script">
                <match>plugindetect</match>
                <match>findplugin</match>
                <match>findnavplugin</match>
                <match>getmimeenabledplugin</match>
                <match>getversiondelimiter</match>
                <match>getpluginfileversion</match>
                <match>detectie</match>
                <match>detectnonie</match>
                <match>detectplatform</match>
                <match>getversion</match>
                <match>ondetectiondone</match>
                <match>hasmimetype</match>
                <match>parsefloat</match>
                <match>return 'msie'</match>
               <!--
                    match text like:
                        if (YPJKLxuEjdM == 'msie' && AfobzC == 8 && fATygwnHuD < 6
               --> <regexp><![CDATA[if\s*\([\w]{1,15}\s*={2,3}\s*['"]msie['"](\s*&&\s*[\w]{1,15}\s*[<>=!]{1,3}\s*[\d\.]{1,5}){2}]]></regexp>
            </search>
        </rule>

        <rule name="JS.HelloEK.B" weight="0" feedback="1">
            <search target="script">
                <match>plugindetect</match>
                <match>findplugin</match>
                <match>findnavplugin</match>
                <match>getmimeenabledplugin</match>
                <match>getversiondelimiter</match>
                <match>getpluginfileversion</match>
                <match>detectie</match>
                <match>detectnonie</match>
                <match>detectplatform</match>
                <match>getversion</match>
                <match>ondetectiondone</match>
                <match>hasmimetype</match>
                <match>parsefloat</match>
                <!--
                    match text like:
                        function rhHGgvv() {
                            return eCcmIOTyfhb("Java"
                --> <regexp><![CDATA[function\s*[\w]{1,15}\s*\(\)\s*{\s*return\s*[\w]{1,15}\s*\(['"]java['"]]]></regexp>
               <!--
                    match text like:
                        if (tNlHDPyao[0] == 1 && hIUNzlB <= 6.32
               --> <regexp><![CDATA[if\s*\([\w\[\]]{1,15}\s*={2,3}\s*[\d\.]{1,5}\s*&&\s*[\w\[\]]{1,15}\s*[<>=!]{1,4}\s*[\d\.]{1,5}]]></regexp>
            </search>
        </rule>
        
        <rule name="JS.MagnitudeEK.A" weight="0" feedback="1">
            <search target="script"> 
                <pre-match>string.fromcharcode</pre-match>
                <match>1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27</match>
                <!--
                match scripts like:
                1. xfp=null;ihs=null;bzm=null;zmwee=null;jsb=null;mbxgg=null;jpghv=null;neege=null;fqc=null;czj=null;bsa=null;mme=null;tljc=null;qkx=null;xbrd=null;wjv=null;oyyyf=null;
                2. vfq=string.fromcharcode(80,89,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,55,81,90,106,65,88,80,48,65,48,65,107,65,65,81,50,65,66,50,66,66,48,66,66,65,66,88,80,56,65,66,117,74,73,122,72,87,1
                -->
                <regexp><![CDATA[([a-zA-Z0-9]{2,5}\s*=\s*null;[\s\S]{0,6}){8}]]></regexp>
                <regexp><![CDATA[string\.fromcharcode\(([0-9]+,){800}]]></regexp>
			</search>
		</rule>

		<rule name="JS.MagnitudeEK.B" weight="0" feedback="1">
            <search target="script">
                <pre-match>var</pre-match>
                <match>1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27</match>
                <match>v:shape</match>
                <match>/msie[\/\s]\d+/i</match>
                <match>/wow64;/i</match>
                <regexp><![CDATA[var\s+([a-zA-Z],\s*){14}]]></regexp>
                <regexp><![CDATA[([a-zA-Z0-9]{2,5}\s*=\s*null;[\s\S]{0,6}){8}]]></regexp>
            </search>
		</rule>

        <rule name="JS.MagnitudeEK.C" weight="0" feedback="1">
            <search target="script">
                <match>dashstyle</match>
                <regexp><![CDATA[var\s+([a-zA-Z],\s*){14}]]></regexp>
                <regexp><![CDATA[([a-zA-Z0-9]{2,5}\s*=\s*null;[\s\S]{0,6}){8}]]></regexp>
            </search>
        </rule>
        
        <rule name="JS.GrandSoftEK.A" weight="0" feedback="1">
            <search target="script">
                <pre-match>function</pre-match>
                <match>"pdf.pdfctrl"</match>
                <match>"acropdf.pdf"</match>
                <match>/adobe acrobat plug-in version ([0-9._]*)/</match>
                <match>/adobe pdf plug-in for firefox and netscape "?([0-9._]*)"?/</match>
                <match>"adobe acrobat"</match>
            </search>
        </rule>

        <rule name="JS.HLEK.A" weight="0" feedback="1">
            <search target="script">
                <pre-match>plugindetect</pre-match>
                <match>var plugindetect={version:"0.8.5"</match>
                <match>plugindetect.init();</match>
                <match>function java1()</match>
                <match>function java2()</match>
                <match>function java3()</match>
                <match>function pdf()</match>
                <match>function bye()</match>
                <match>getversion("java")</match>
            </search>
        </rule>

		<rule name="JS.NeutrinoEK.C" weight="0" feedback="1">
			<search target="script"> 
                <match>quicktime</match>
                <match>realplayer</match>
                <match>shockwave</match>
                <match>silverlight</match>
                <match>plugindetect</match>
                <match>adobereader</match>
                <match>java</match>
                <match>flash</match>
                <match>$(document).ready(</match>
                <match>$.post(</match>
                <regexp><![CDATA[function xor\([\s\S]{38,80}math.floor[\s\S]{10,30}string.fromcharcode[\s\S]{38,64}}]]></regexp>
			</search>
		</rule>

		<rule name="JS.NeutrinoEK.D" weight="0" feedback="1">
			<search target="script"> 
                <match>$(document).ready</match>
                <match>$.post</match>
                <regexp><![CDATA[function [a-zA-Z0-9_]{1,6}\([\s\S]{60,110}math\.floor[\s\S]{30,100}string\.fromcharcode[\s\S]{2,40}}]]></regexp>
			</search>
		</rule>
        
                
        <rule name="JS.NeutrinoEK.E" weight="0" feedback="1">
            <search target="script">
                <match>plugindetect</match>
                <match>.getversion</match>
                <match>adobereader</match>
                <match>java</match>
                <match>flash</match>
                <!--
                    match text like:
                        $.post(f, a, function (a,b) {
                            $("body").append(
                -->
                <regexp><![CDATA[\$\.post\([\w\s,]{1,30}function[\s\S]{1,100}\$\(['"]body['"]\)\.append\(]]></regexp>
            </search>
        </rule>

		<rule name="JS.AnglerEK.A" weight="0" feedback="1">
			<search target="script"> 
                <match>d27cdb6e-ae6d-11cf-96b8-444553540000</match>
				<regexp><![CDATA[if\s*\((window\.[^)]+){2}\)[\s\S]{200,600}xkey=[0-9\+'"]{5,15}&exec=\S{20,40}]]></regexp>
			</search>
		</rule>

		<rule name="JS.AnglerEK.B" weight="0" feedback="1">
			<search target="script"> 
                <match>application/x-silverlight-2</match>
				<!-- 
					match text like:
						"exte"+"eec"="
						"ex"+"te"+"eec"="
						"ex"+"teeec"="
				-->
			   <regexp><![CDATA[if\s*\((window\.[^)]+){3}\)\s*{[\s\S]{200,600}value=['"]e(['"]\s*\+\s*['"])?x(['"]\s*\+\s*['"])?t(['"]\s*\+\s*['"])?e(['"]\s*\+\s*['"])?e(['"]\s*\+\s*['"])?e(['"]\s*\+\s*['"])?c(['"]\s*\+\s*['"])?=\S{20,40}]]></regexp>
			</search>
		</rule>

		<rule name="JS.AnglerEK.C" weight="0" feedback="1">
			<search target="script"> 
                <match><![CDATA[<applet]]></match>
				<!-- 
					match text like:
						"exte"+"eec"="
						"ex"+"te"+"eec"="
						"ex"+"teeec"="
				-->
				<regexp><![CDATA[if\s*\((window\.[^)]+){2}\)[\s\S]{0,600}e(['"]\s*\+\s*['"])?x(['"]\s*\+\s*['"])?t(['"]\s*\+\s*['"])?e(['"]\s*\+\s*['"])?e(['"]\s*\+\s*['"])?e(['"]\s*\+\s*['"])?c(['"]\s*\+\s*['"])?['"]]]></regexp>
			</search>
		</rule>
		
		<rule name="JS.AnglerEK.D" weight="0" feedback="1">
			<search target="script">
				<match>window.geturl</match>
				<match>window.getkey</match>
				<regexp><![CDATA[document\.namespaces\.add\(['"][^'"]{1,20}['"],\s*['"]urn:schemas-microsoft-com:vml['"],\s*['"]#default#vml['"]\)]]></regexp>
			</search>
		</rule>
        
        <rule name="JS.AnglerEK.E" weight="0" feedback="1">
            <search target="script">
                <match><![CDATA[<<]]></match>
                <!--
                    match text like:
                        z8tk('2324234f34343fgr34j34h5gh686','2343k546k46k45').......z8tk('we2342334j3k45h6gh7j8886456j','er2323422345')......                
                -->
                <regexp><![CDATA[([\w]{1,15})\s*\(\s*['"][a-zA-Z0-9]{1,500}?['"]\s*,\s*['"][a-zA-Z0-9]{1,100}?['"]\s*\)[\s\S]{1,100}(\1\s*\(\s*['"][a-zA-Z0-9]{1,500}?['"]\s*,\s*['"][a-zA-Z0-9]{1,100}?['"]\s*\)[\s\S]{1,100}){25}]]></regexp>
            	<!--
                    match text like:
                        =a$av<<18|gr1k<<12|qn2g6<<6|
                -->
                <regexp><![CDATA[=(\s*[\w\$]{1,15}\s*<<\s*[\d]{1,3}\s*\|\s*){3}]]></regexp>
            </search>
        </rule>

        <rule name="JS.AnglerEK.F" weight="0" feedback="1">
            <search target="script">
                <pre-match>outerhtml</pre-match>
                <regexp><![CDATA[msie.{1,50}\.exec\(]]></regexp>
                <regexp><![CDATA[document\.body\.outerhtml[\s\S]{1,100}new\s*regexp\([\s\S]{1,100}\.exec\(]]></regexp>
                <regexp><![CDATA[[0-9A-Za-z]{4,11}\(['"][0-9A-Za-z]{5,12}['"]\)]]></regexp>
            </search>
        </rule>

		<rule name="JS.GongDa.C" weight="0" feedback="1">
			<search target="script">
			    <pre-match>navigator.userAgent</pre-match>
			    <pre-match>getPlayerVersion</pre-match>				   
				<regexp><![CDATA[=\s*eval[\s\S]{0,100}=\s*unescape[\s\S]{0,100}=\s*('|")[^\'\"]{2000,}]]></regexp>					   
			</search>
		</rule>
		
		<rule name="JS.GongDa.D" weight="0" feedback="1">
			<search target="script">
			    <match>gondadx</match>
				<match>gondady</match>
				<search target="method">
					<pre-match>eval</pre-match>
					<search target="object">
						<match>window</match>
					</search>
					<search target="param">
						<regexp><![CDATA[document\.write(ln)?\(('|")\<iframe]]></regexp>					   
					</search>
				</search>
			</search>
		</rule>

		<rule name="JS.CSS.A" weight="20">
			<search target="script" encryptedDegree="1">
				<pre-match>createcss</pre-match>
				<regexp><![CDATA[createcss\(('|")#[^'"]{2,4}('|"),('|")background:url\(data:,(eval|(va)?string\.fromcharcode)\)('|")]]></regexp>
			</search>
		</rule>

		<rule name="JS.CSS.B" weight="0" feedback="1">
			<search target="script">
				<pre-match>backgroundimage</pre-match>
				<regexp><![CDATA[\.style\.backgroundimage\.match\(\/url\\\("\?data\\:\[\^,\]\*,\(\[\^"\)\]\+\)"\?\\\)\/\)\[1\]]]></regexp>
			</search>
		</rule>

		<rule name="JS.IEOuterHTML.A" weight="0" feedback="1">
			<search target="script">
				<pre-match>outerhtml</pre-match>
				<regexp>document\.getelementsbytagname\((\"|\')style(\"|\')\)[\s\S]{1,50}\.outerhtml\s*=\s*(\"|\')[\s\S]{1,20}(\"|\')</regexp>
			</search>
		</rule>

		<rule name="JS.StrangeTryCatch.A" weight="0" feedback="1">
			<search target="script">
				<pre-match>activexobject</pre-match>
				<regexp>try\s*\{\s*new\s*activexobject\((\"|\')\s*(\"|\')\)</regexp>
			</search>
		</rule>

		<rule name="JS.StrangeTryCatch.B" weight="0" feedback="1">
			<search target="script">
				<pre-match>alert</pre-match>
				<regexp>try\s*\{\s*alert\(a,b,c\)</regexp>
			</search>
		</rule>

		<rule name="JS.StrangeTryCatch.D" weight="0" feedback="1">
			<search target="script">
				<pre-match>prototype</pre-match>
				<regexp>try\s*\{\s*new[^\{\}]{1,30}\.prototype[^\{\}]{0,5}\s*\}</regexp>
			</search>
		</rule>
		
		<rule name="JS.StrangeTryCatch.E" weight="0" feedback="1">
			
				<search target="method">
					<pre-match>eval</pre-match>
					<search target="object">
						<match>window</match>
					</search>
					<search target="param">
						<regexp><![CDATA[try\s*\{[^\{\}]{0,10}prototype[^\{\}]{0,10}\}]]></regexp>					   
					</search>
				</search>
			
		</rule>
		
		<rule name="JS.StrangeTryCatch.F" weight="0" feedback="1">
			<search target="script">
				<pre-match>prototype</pre-match>
				<regexp><![CDATA[try\s*\{[^\{\}]{0,10}prototype[^\{\}]{0,10}\}[\s\S]{1,500}('|")[^\'\"]{2000,}('|")]]></regexp>
			</search>
		</rule>

		<rule name="JS.PhoenixKit.A" weight="20">
			<search target="script">
				<pre-match>yahoo</pre-match>
				<regexp>try\s*\{\s*document\.getelementbyid\((\"|\')yahoo(\"|\')\)\.internet\}</regexp>
			</search>
		</rule>

		<rule name="JS.PhoenixKit.B" weight="0" feedback="1">
			<search target="script">
				<pre-match>getelementsbytagname</pre-match>
				<regexp><![CDATA[createelement[\s\S]{1,200}(document\.getelementsbytagname\('\*'\)\[\d+\][\s\S]{1,200}){2,}]]></regexp>
			</search>
		</rule>

		<rule name="JS.CVE-2012-0003.A" weight="20">
			<search target="method">
				<match>collectgarbage</match>
				<search target="object">
					<match>_global</match>
				</search>
			</search>
			<search target="method">
				<match>getclassid</match>
				<search target="object">
					<match>document.object</match>
				</search>
				<search target="param">
					<match>22d6f312-b0f6-11d0-94ab-0080c74c7e95</match>
				</search>
			</search>
			<search target="method">
				<match>play</match>
				<search target="object">
					<match>document.object</match>
				</search>
			</search>
		</rule>

		<rule name="JS.Landing.A" weight="0" feedback="1">
			<search target="script" encryptedDegree="1">
				<search target="method">
					<pre-match>write</pre-match>
					<search target="object">
						<match>document</match>
					</search>
					<search target="param">
					<regexp><![CDATA[http://[^/]{1,100}/cgi-bin/[^\?]{1,20}\?id=[\d]*&[^&]{10,60}&ref=('|")\+escape\(document\.referrer\)]]></regexp>
					</search>
				</search>
			</search>
		</rule>

		<rule name="JS.Landing.B" weight="0" feedback="1">
			<search target="script" encryptedDegree="1">
				<search target="method">
					<pre-match>eval</pre-match>
					<search target="object">
						<match>window</match>
					</search>
					<search target="param">
					<regexp><![CDATA[http://[^/]{1,100}/in\.cgi\?\d&[^&]{10,60}&seoref=('|")\+encodeuricomponent\(document\.referrer\)[^&]{10,80}&http_referer=('|")\+encodeuricomponent\(document\.url\)]]></regexp>
					</search>
				</search>
			</search>
		</rule>

		<rule name="JS.Twetti.q.A" weight="0" feedback="1">
			<desp>return jsBs(jsB(jsBs(jsB(jsBb))))</desp>
			<search target="script">
				<pre-match>constructor</pre-match>
				<regexp><![CDATA[return\s+(?:[a-z]{1,9}\(){4,}[a-z]{1,9}(?:\)){4,}]]></regexp>
			</search>
		</rule>

		<rule name="JS.Twetti.k.A" weight="0" feedback="1">
			<search target="script">
				<pre-match>split</pre-match>
				<regexp><![CDATA[split\(\'\s+\!\s+#\s+\$\s+\%\s+\&\s+\(\s+\)\s+\*\s+\+\s+\,\s+\-\s+\.\s+\/.{120,150}join\(\S+\.pop]]></regexp>
			</search>
		</rule>

		<rule name="JS.Redirector.sa.A" weight="0" feedback="1">
			<search target="script">
				<pre-match>split</pre-match>
				<regexp><![CDATA[split\(\'\!\#\$\%\&\*\+\-\/\<\>\?\@.{30,40}join\(\S+\.pop]]></regexp>
			</search>
		</rule>

		<rule name="JS.Iframe.cnp.A" weight="0" feedback="1">
			<search target="script">
				<pre-match>fromcharcode</pre-match>
				<regexp><![CDATA[117,110,100,101,102,105,110,101,100.{25,30}99,114,101,97,116,101,69,108,101,109,101,110,116.{5,10}105,102,114,97,109,101]]></regexp>
			</search>
		</rule>

		<rule name="JS.Agent.gnk.A" weight="0" feedback="1">
			<search target="script">
				<pre-match>eval</pre-match>
				<regexp><![CDATA[\"(\\x[0-9a-zA-Z][0-9a-zA-Z]){128,128}\"\,\"(\\x[0-9a-z][0-9a-z])\"\,\"(\\x[0-9a-z][0-9a-z]){5,5}\"\,\"(\\x[0-9a-z][0-9a-z]){227,227}\"]]></regexp>
			</search>
		</rule>

		<rule name="JS.Agent.gfj.A" weight="0" feedback="1">
			<search target="script">
				<pre-match>createelement</pre-match>
				<regexp><![CDATA[[a-z]{5,}\s*\+=\s*string\.fromcharcode\(parseint\([^,]{5,},\d{2,}\)\^\S\)]]></regexp>
			</search>
		</rule>

		<rule name="JS.Iframe_qpi.A" weight="0" feedback="1">
			<search target="all">
				<pre-match>/*qpi*/</pre-match>
				<regexp><![CDATA[document\.createelement\(\'iframe\'\)[\s\S]{0,200}\.src\s*=\s*('|")http[\s\S]{0,500}appendchild]]></regexp>
			</search>
		</rule>

		<rule name="JS.Agent.A" weight="0" feedback="1">
			<search target="script">
				<pre-match>split</pre-match>
				<regexp><![CDATA[(?:\"[^\"]{1,20}\",){300,301}]]></regexp>
				<regexp><![CDATA[(?:\-?\d+[a-zA-Z]{1,2}){300,301}]]></regexp>
			</search>
		</rule>

		<rule name="JS.Agent.B" weight="0" feedback="1">
			<search target="script">
				<search target="method">
					<pre-match>eval</pre-match>
					<search target="object">
						<match>window</match>
					</search>
					<search target="param">
						<regexp><![CDATA[document\.createelement\(('|")script('|")[\s\S]{1,300}\.src\s*=[\s\S]{1,200}\.appendchild]]></regexp>
					</search>
				</search>
			</search>
			<search target="script">
				<pre-match>split</pre-match>
				<regexp><![CDATA[(?:\-?\d+[a-zA-Z]{1,2}){30,31}]]></regexp>
			</search>
		</rule>

		<rule name="JS.Redirector.A" weight="0" feedback="1">
			<search target="method">
				<pre-match>setattribute</pre-match>
				<search target="object">
					<match>document.script</match>
				</search>
				<search target="param">
					<regexp><![CDATA[s\.php\?ref=&lc=]]></regexp>
				</search>
			</search>
		</rule>

		<rule name="JS.Redirector.B" weight="0" feedback="1">
			<search target="method">
				<pre-match>unescape</pre-match>
			</search>

			<search target="method">
				<pre-match>setattribute</pre-match>
				<search target="object">
					<match>document.script</match>
				</search>
				<search target="param">
					<regexp><![CDATA[chinahr\.com\.php]]></regexp>
				</search>
			</search>
		</rule>

		<rule name="JS.CVE-2012-1889.A" weight="10" feedback="1">
			<search target="all">
				<pre-match>f6d90f11-9c73-11d3-b32e-00c04f990bb4</pre-match>
			</search>
			<search target="method">
				<pre-match>definition</pre-match>
				<search target="object">
					<match>object</match>
				</search>
			</search>
		</rule>

		<rule name="JS.CVE-2007-5660.A" weight="20">
			<search target="all">
				<pre-match>e9880553-b8a7-4960-a668-95c68bed571e</pre-match>
			</search>
			<search target="method">
				<pre-match>downloadandexecute</pre-match>
				<search target="object">
					<match>object</match>
				</search>
				<search target="param">
						<regexp><![CDATA[http]]></regexp>
				</search>
			</search>
		</rule>
		
		<rule name="JS.CVE-2009-0950.B" weight="20">
			<search target="script">
				<match>document.location.assign</match>
				<regexp><![CDATA[document.location.assign\(('itms://[^\']{500,}'|"itms://[^\"]{500,}")\)]]></regexp>
			</search>
		</rule>

		<rule name="JS.MaybeLeakInfo.A" weight="0" feedback="1">
			<search target="method">
				<match>setattribute</match>
				<search target="object">
					<match>document.script</match>
				</search>
				<search target="param">
					<match>src</match>
					<regexp><![CDATA[res://[\s\S]{1,50}(aim|tencent|aliwangwang|microsoft|adobe|kaspersky|trend|360|keniu|norton|bitdefender)[\s\S]{1,50}]]></regexp>
				</search>
			</search>
		</rule>
	
		<rule name="JS.Kaixin.A" weight="0" feedback="1">
			<search target="method">
				<pre-match>write</pre-match>
				<search target="object">
					<match>document</match>
				</search>
				<search target="param">
					<regexp><![CDATA[document\.createelement[\s\S]{1,100}\.class[\s\S]{1,100}(width|height)[\s]*=[\s]*('|"){0,1}[0-9]\W('|"){0,1}[\s\S]{1,100}appendchild[\s\S]{1,200}]]></regexp>
				</search>
			</search>
		</rule>
		
		<rule name="JS.2012-4792.A" weight="0" feedback="1">
			<search target="script">
				<match>d27cdb6e-ae6d-11cf-96b8-444553540000</match>
				<pre-match>sharepoint.opendocuments</pre-match>
				<pre-match>shockwaveflash.shockwaveflash</pre-match>
				<regexp><![CDATA[document\.body\.innerhtml\s*\+?=\s*\<object[\s\S]{1,300}\.(swf|pdf|jar|class)[\s\S]{0,300}\<iframe]]></regexp>
			</search>
		</rule>
      
		<rule name="JS.2012-4792.B" weight="0" feedback="1">
			<search target="script">        
				<pre-match>activexobject</pre-match>
				<pre-match>xmlhttprequest</pre-match>
				<regexp><![CDATA[ajax\(\)[\s\S]{0,100}\.open\([\s\S]{0,100}\.send\([\s\S]{0,100}\.responsetext[\s\S]{0,100}\.replace[\s\S]{0,100}unescape\(]]></regexp>
			</search>
		</rule>
		
		<rule name="JS.2012-4792.C" weight="0" feedback="1">
			<search target="script">        
				<pre-match>collectgarbage</pre-match>
				<regexp><![CDATA[collectgarbage\([\s\S]{1,200}document\.getelementbyid[\s\S]{1,400}\.outertext[\s\S]{0,200}collectgarbage\([\s\S]{1,100}(for|while)[^{]{0,100}\{[^\{\}]{0,300}unescape\(]]></regexp>
			</search>
		</rule>
		
		<rule name="JS.2012-4792.D" weight="0" feedback="1">
			<search target="script">        
				<pre-match>collectgarbage</pre-match>
				<regexp><![CDATA[document\.createelement\(('|")[a-z]?button('|")\)[\s\S]{0,300}collectgarbage[\s\S]{0,300}\.location\s*=]]></regexp>
			</search>
		</rule>
		
		<rule name="JS.2012-4792.E" weight="0" feedback="1">
		    
				<search target="method">
					<pre-match>eval</pre-match>
					<search target="object">
						<match>window</match>
					</search>
					<search target="param">
						<regexp><![CDATA[document\.createelement\(('|")[a-z]?button('|")\)[\s\S]{0,300}collectgarbage[\s\S]{0,300}\.location\s*=]]></regexp>
					</search>
				</search>
			
		</rule>
		
		<rule name="JS.2012-4792.F" weight="0" feedback="1">
			<search target="script">        
				<pre-match>collectgarbage</pre-match>
				<regexp><![CDATA[document\.createelement\(('|")[a-z]?button('|")\)[\s\S]{0,300}=\s*null[\s\S]{0,300}collectgarbage]]></regexp>
			</search>
		</rule>
		
		<rule name="JS.2012-4792.G" weight="20">
			<search target="script">        
				<pre-match>collectgarbage</pre-match>
				<regexp><![CDATA[document\.createelement\(('|")[a-z]?button('|")\)[\s\S]{0,300}=\s*('|")\s*('|")[\s\S]{0,300}collectgarbage]]></regexp>
			</search>
		</rule>
		
		<rule name="JS.2012-4792.H" weight="20">
		    
				<search target="method">
					<pre-match>eval</pre-match>
					<search target="object">
						<match>window</match>
					</search>
					<search target="param">
						<regexp><![CDATA[document\.createelement\(('|")[a-z]?button('|")\)[\s\S]{0,300}=\s*null[\s\S]{0,300}collectgarbage]]></regexp>
					</search>
				</search>
			
		</rule>
		
		<rule name="JS.2012-4792.I" weight="0" feedback="1">
		    
				<search target="method">
					<pre-match>eval</pre-match>
					<search target="object">
						<match>window</match>
					</search>
					<search target="param">
						<regexp><![CDATA[document\.createelement\(('|")[a-z]?button('|")\)[\s\S]{0,300}=\s*('|")\s*('|")[\s\S]{0,300}collectgarbage]]></regexp>
					</search>
				</search>
			
		</rule>

		<rule name="JS.StrangeOnload.A" weight="0" feedback="1">
			<search target="script">
				<search target="method">
					<pre-match>activexobject</pre-match>
					<search target="object">
						<match>_global</match>
					</search>
					<search target="param">
						<pre-match>shockwaveflash.shockwaveflash</pre-match>
					</search>
				</search>
				<search target="method">
					<pre-match>write</pre-match>
					<search target="object">
						<match>document</match>
					</search>
					<search target="param">
						<regexp><![CDATA[<body\s*onload\s*=\s*[\s\S]{1,30}\(\)]]></regexp>
					</search>
				</search>
			</search>
		</rule>   

		<rule name="JS.EncodeExe.A" weight="0" feedback="1">
		    
				<search target="method">
					<pre-match>write</pre-match>
					<search target="object">
						<match>document</match>
					</search>
					<search target="param">
						<pre-match>clsid:66666666-6666-6666-6666</pre-match>
						<regexp><![CDATA[<object[^><]{0,100}classid\s*=\s*[^><]{0,100}codebase\s*=\s*[^><]{0,50}\.exe]]></regexp>
					</search>
				</search>
			
		</rule>
		
		<rule name="JS.LoadExe.A" weight="0" feedback="1">
		    
				<search target="method">
					<pre-match>write</pre-match>
					<search target="object">
						<match>document</match>
					</search>
					<search target="param">
					<regexp><![CDATA[<object[^><]{0,200}(width|height)\s*=\s*('|"){0,1}[0-9]\W('|"){0,1}[^><]{0,100}codebase\s*=\s*[^><]{0,50}\.exe]]></regexp>
					</search>
				</search>
			
		</rule>
		
		
		<rule name="JS.MaliciousUrl.A" weight="0" feedback="1">
		    <search target="script">
				<pre-match>document.createelement</pre-match>
				<match>/trm/requesting/languages-safe-return.php</match>
				<match>getjavainfo.jar</match>
				<match>end_redirect</match>
			</search>
		</rule>
                   
		<rule name="JS.CoolEK.B" weight="0" feedback="1">
			<desp>Cool Exploit Kit</desp> 
				<search target="method">
					<pre-match>eval</pre-match>
					<search target="object">
						<match>window</match>
					</search>
					<search target="param">
						<pre-match>.push(function</pre-match>
						<regexp><![CDATA[\.innerhtml\s*=\s*("|'){0,1}\<object]]></regexp>
					</search>
				</search>
		</rule>

		<rule name="JS.CoolEK.C" weight="20">
			<desp>Cool Exploit Kit</desp> 
			
				<search target="method">
					<pre-match>eval</pre-match>
					<search target="object">
						<match>window</match>
					</search>
					<search target="param">
						<pre-match>getmimeenabledplugin</pre-match>
						<match>getpluginfileversion</match>
						<match>.initscript(</match>
						<match>.getversion(</match>
						<match>.push(function</match>
						<regexp><![CDATA[\.innerhtml\s*=\s*("|'){0,1}\<object]]></regexp>
					</search>
				</search>
			
		</rule>

		<rule name="JS.CoolEK.D" weight="0" feedback="1">
			<desp>Cool Exploit Kit</desp> 
				<search target="method">
					<pre-match>eval</pre-match>
					<search target="object">
						<match>window</match>
					</search>
					<search target="param">
						<pre-match>getmimeenabledplugin</pre-match>
						<match>getpluginfileversion</match>
						<match>.initscript(</match>
						<match>.getversion(</match>
						<match>8ad9c840-044e-11d1-b3e9-00805f499d93</match>
						<regexp><![CDATA[\.innerhtml\s*=\s*("|'){0,1}\<object]]></regexp>
					</search>
				</search>
		</rule>
		
		<rule name="JS.CVE-2014-0322.A" weight="20">
			<search target="script">
                <pre-match>onpropertychange</pre-match>
                <pre-match>collectgarbage</pre-match>
                <regexp><![CDATA[\w+\.(getelementsbytagname|getelementbyid)\([\s\S]{0,200}onpropertychange[\s\S]{0,100}\.createelement\(["']select["']\)[\s\S]{0,80}appendchild]]></regexp>
                <regexp><![CDATA[this\.outerhtml\s*=\s*this\.outerhtml[\s\S]{0,200}collectgarbage]]></regexp>
			</search>
        </rule>

		<rule name="JS.CVE-2014-1776.B" weight="0" feedback="1">
			<search target="script">
				<match>.onpropertychange</match>
				<match>.removenode</match>
				<match>.getelementbyid</match>
				<match>.createelement</match>
				<match>v:shape</match>
			</search>
		</rule>	

        <rule name="JS.UseAfterFree.A" weight="0" feedback="1">
            <search target="script">
                <pre-match>dword2data</pre-match>
                <pre-match>collectgarbage</pre-match>
                <regexp><![CDATA[(\\x[0-9a-f][0-9a-f]){4}]]></regexp>
            </search>
        </rule>	

        <rule name="JS.UseAfterFree.B" weight="0" feedback="1">
            <search target="script">
                <pre-match>dword2data</pre-match>
                <pre-match>collectgarbage</pre-match>
                <regexp><![CDATA[%u[0-9a-c]{4}%u[0-9a-c]{4}]]></regexp>
            </search>
        </rule>	

        <rule name="JS.UseAfterFree.C" weight="0" feedback="1">
            <search target="script">
                <pre-match>dword2data</pre-match>
                <pre-match>collectgarbage</pre-match>
                <regexp><![CDATA[0x[0-9a-c]{8}]]></regexp>
            </search>
        </rule>	

		<rule name="JS.GenericEK.A" weight="0" feedback="1">
			<desp>Generic Exploit Kit</desp> 
			
				<search target="method">
					<pre-match>eval</pre-match>
					<search target="object">
						<match>window</match>
					</search>
					<search target="param">
						<pre-match>.initscript()</pre-match>
						<match>.getversion(</match>
						<match>arcall()</match>
					</search>
				</search>
			
		</rule>

		<rule name="JS.BlackholeKit.M" weight="0" feedback="1">
			<desp>Blackhole Exploit Kit</desp> 
			
				<search target="method">
					<pre-match>eval</pre-match>
					<search target="object">
						<match>window</match>
					</search>
					<search target="param">
						<pre-match>getshellcode()</pre-match>
						<pre-match>j1()</pre-match>
						<pre-match>p1()</pre-match>
						<pre-match>f1()</pre-match>
						<match>.initscript()</match>
						<match>.getversion(</match>
						<match>arcall()</match>
					</search>
				</search>
			
		</rule>

		<rule name="JS.BlackholeKit.O" weight="0" feedback="1">
			<desp>Blackhole Exploit Kit</desp> 
			<search target="script">
				<search target="method">
					<pre-match>eval</pre-match>
					<search target="object">
						<match>window</match>
					</search>
					<search target="param">
						<pre-match>.getversion</pre-match>
						<pre-match>getmimeenabledplugin</pre-match>
						<match>javaver</match>
						<match>pdfver</match>
						<match>function java1</match>
						<match>function java2</match>
						<match>function java3</match>
					</search>
				</search>
			</search>
        </rule>

       	<rule name="JS.Styx.A" weight="20">
			<search target="script">
				<pre-match>getelementbyid</pre-match>
				<match>contentwindow</match>
				<match>fromcharcode</match>
                <regexp>getelementbyid\([^)]+\)\.contentwindow[\S\s]{0,100}for\s*\([^)]+\)\s*.{1,40}string.fromcharcode\([^)]*value[^)]*\)</regexp>
			</search>
		</rule>

		<rule name="JS.Styx.B" weight="0" feedback="1">
            <search target="script">
                <pre-match>getelementbyid</pre-match>
                <match>contentwindow</match>
                <match>fromcharcode</match>
                <regexp>getelementbyid[\s\S]{1,30}\.contentwindow[\S\s]{0,100}for\s*\([^)]+\)\s*.{1,40}string.fromcharcode\([^)]*value[^)]*\)</regexp>
            </search>
        </rule>

        <rule name="JS.G01Pack.A" weight="0" feedback="1">
            <!--
                 match for the following function patterns
                 function e(r) {
                    return r.length;
                 }
                 function L() {
                    return null;
                 }
             -->
            <search target="script">
                <pre-match>function</pre-match>
                <match>return</match>
                <match>length</match>
                <regexp>function +[a-zA-Z0-9_$]+\(([a-zA-Z0-9_$]+)\)\s*\{\s*return \1\.length;?\s*\}</regexp>
                <regexp>function +[a-zA-Z0-9_$]+\(\)\s*\{\s*return null;?\s*\}</regexp>
            </search>
        </rule>

        <rule name="JS.G01Pack.B" weight="0" feedback="1">
            <!--
                 match for the following function patterns
                 function m(u) {
                    var E = {
                        ...
                    };
                    ...
                    for (var Y in E) {
                        if (Y == u) {
                            ...
                        }
                    }
                    ...
                 }
             -->
            <search target="script">
                <pre-match>function</pre-match>
                <regexp><![CDATA[function +[a-zA-Z0-9_$]+\(([a-zA-Z0-9_$]+)\)\s*\{\s*var ([a-zA-Z0-9_$]+)\s*=\s*\{[^\}]+\}[\S\s]{0,1000}for\s*\([^)]+in \2\)\s*\{\s*if\s*\(([a-zA-Z0-9_$]+\s*==\s*\1|\1\s*==\s*[a-zA-Z0-9_$]+)\)]]></regexp>
            </search>
        </rule>

        <!--
            The following rule, JS.G01Pack.C, is a combination of {JS.G01Pack.A, JS.G01Pack.B, JS.IframeHidden.GD}
        -->
        <rule name="JS.G01Pack.C" weight="0" feedback="1">
            <search target="script">
                <pre-match>function</pre-match>
                <match>return</match>
                <match>length</match>
                <regexp><![CDATA[function\s+[a-zA-Z0-9_$]+\(([a-zA-Z0-9_$]+)\)\s*\{\s*return \1\.length;?\s*\}]]></regexp>
                <regexp><![CDATA[function\s+[a-zA-Z0-9_$]+\(\)\s*\{\s*return\s+null;?\s*\}]]></regexp>
                <regexp><![CDATA[function\s+[a-zA-Z0-9_$]+\(([a-zA-Z0-9_$]+)\)\s*\{\s*var ([a-zA-Z0-9_$]+)\s*=\s*\{[^\}]+\}[\S\s]{0,1000}for\s*\([^)]+in \2\)\s*\{\s*if\s*\(([a-zA-Z0-9_$]+\s*==\s*\1|\1\s*==\s*[a-zA-Z0-9_$]+)\)]]></regexp>
                <search target="method">
                    <match>createelement</match>
                    <search target="param">
                        <match>iframe</match>
                    </search>
                </search>
                <search target="method">
                    <match>appendchild(iframe)</match>
                    <search target="param">
                        <match>position: 293</match>
                    </search>
                </search>
            </search>
        </rule>
        
		<rule name="JS.PrivateEK.B" weight="0" feedback="1">
			<search target="script">
                <pre-match>.getversion</pre-match>
                <pre-match>plugindetect</pre-match>
                <match>.getversion</match>
                <match>plugindetect</match>
                <match>createelement</match>
                <match>appendchild</match>
                <regexp><![CDATA[if\s*\(\([a-zA-Z0-9_]+\[1\]\s*==\s*6\)\s*&&\s*\([a-zA-Z0-9_]+\[3\]\s*<=\s*[0-9]{1,2}\)\)]]></regexp>
                <regexp><![CDATA[if\s*\(\([a-zA-Z0-9_]+\[1\]\s*==\s*7\)\s*&&\s*\([a-zA-Z0-9_]+\[3\]\s*<=\s*[0-9]{1,2}\)\)]]></regexp>
			</search>
        </rule>

		<rule name="JS.CKPack.A" weight="0" feedback="1">
			<search target="script">
                <pre-match>ck</pre-match>
                <match>ck_</match>
                <match>cookie</match>
                <match>/*jsck</match>
                <match>||||||||||||||||||||||||||||||||||||||||||</match>
			</search>
		</rule>

		<rule name="JS.StampEK.A" weight="0" feedback="1">
			<search target="script">
                <pre-match>settimeout</pre-match>
                <match>applet</match>
                <match>settimeout</match>
                <regexp><![CDATA[var\s+id\s*=\s*['"][a-zA-Z0-9]+['"];]]></regexp>
                <regexp><![CDATA[<applet .{1,60}code=['"]secretkey['"]]]></regexp>
			</search>
		</rule>

		<rule name="JS.StampEK.B" weight="0" feedback="1">
			<search target="script">
                <pre-match>settimeout</pre-match>
                <regexp><![CDATA[var\s+[a-zA-Z0-9]+\s*=\s*['"]createel['"];]]></regexp>
                <regexp><![CDATA[var\s+[a-zA-Z0-9]+\s*=\s*['"]ement['"];]]></regexp>
                <regexp><![CDATA[var\s+[a-zA-Z0-9]+\s*=\s*['"]byid['"];]]></regexp>
			</search>
        </rule>

		<rule name="JS.WhiteholeKit.A" weight="0" feedback="1">
			<desp>for sourcing</desp> 
			<search target="script"> 
				<search target="method">
					<pre-match>getclassid</pre-match>
					<search target="param">
						<match>cafeefac-dec7-0000-0001-abcdeffedcba</match>
					</search>
				</search>
				<search target="method">
					<search target="param">
						<pre-match>applet</pre-match>
						<regexp><![CDATA[<[\s\S]{0,10}applet[\s\S]{0,100}.class[\s\S]{0,100}archive=[\s\S]{1,20}.jar[\s\S]{0,1000}applet[\s\S]{0,10}>]]></regexp>
					</search>
				</search>
			</search>
		</rule>

		<rule name="JS.CVE-2013-2551.A" weight="20">
			<search target="method">
				<pre-match>setlength</pre-match>
				<search target="object">
					<match>dashstyle.array</match>
				</search>
				<search target="param">
					<regexp>-\d+</regexp>
				</search>
			</search>
		</rule>

		<rule name="JS.CVE-2013-2551.B" weight="20">
			<search target="script"> 
				<pre-match>dashstyle.array.length</pre-match>
				<regexp>\.dashstyle\.array\.length\s*=\s*0\s*-\s*1</regexp>
			</search>
		</rule>

		<rule name="JS.CVE-2013-3897.A" weight="20">
			<search target="script"> 
				<match>.swapnode</match>
				<match>.onselect</match>
				<match>.execcommand</match>
				<match>.onpropertychange</match>
			</search>
			<search target="method">
				<match>unescape</match>
				<search target="param">
					<pre-match>%u4141%u4141</pre-match>
					<pre-match>%u1414%u1414</pre-match>
				</search>
			</search>
		</rule>

		<rule name="JS.CheckAV.A" weight="20">
			<desp>Exploit Kit will check if Kaspersky and Trendmico AV are installed</desp>

			<search target="method">
				<pre-match>loadxml</pre-match>
				<search target="object">
					<match>microsoft.xmldom</match>
				</search>
				<search target="param">
					<pre-match>res://c:\windows\system32\drivers\kl1.sys</pre-match>
				</search>
			</search>

			<search target="method">
				<pre-match>loadxml</pre-match>
				<search target="object">
					<match>microsoft.xmldom</match>
				</search>
				<search target="param">
					<match>res://c:\windows\system32\drivers\tmactmon.sys</match>
				</search>
			</search>
		</rule>

	</rule-set>
</rule-set>

<rule-set category="HTML Static">
	<rule-set category="Generic">	
		<rule name="JAR.SmallWindowSize.C" weight = "10" feedback="1">  
			<desp>HTML Signature/Too small windows size for applet</desp> 
			<search target="static">
			   	<pre-match>applet</pre-match>
				<regexp><![CDATA[<(applet|object)[\s\S]{1,200}(archive|codebase|data)[\s\S]{10,80}\.(in|info|tk|cc|cu|to)\/[\s\S]{1,200}(width|height)[\s]*=[\s]*('|"){0,1}[0-9]\W('|"){0,1}]]></regexp>
			</search>
		</rule>
		
		<rule name="JAR.SmallWindowSize.D" weight = "0"  feedback="1">  
			<desp>HTML Signature/Too small windows size for applet</desp> 
			<search target="static">
			  	<pre-match>applet</pre-match>
			   	<regexp><![CDATA[<applet\s*archive\s*=\s*('|")exploit\.jar('|")\s*code\s*=\s*('|")exploit\.class('|")\s*(width|height)\s*=\s*('|")[0-9]('|")]]></regexp>
			</search>
		</rule>
		
		<rule name="JAVA.SmlWinValueU.A" weight="0" feedback="1">
			<desp>HTML Signature/Small Window Size and param value begins with U</desp> 
			<search target="static">
			   	<pre-match>applet</pre-match>
				<regexp><![CDATA[<applet[^<>]*(width|height)\s*=\s*('|"){0,1}[0-9]\W('|"){0,1}[^>]*>\s*<param[^<>]{1,100}value\s*=\s*('|")u\/\/]]></regexp>
			</search>
		</rule> 
		
		<rule name="HTML.PDFinIframe.A" weight="20">
			<desp>HTML Signature/The postfix of src in iframe is PDF</desp>
			<search target="static">
			   	<pre-match>iframe</pre-match>
				<regexp><![CDATA[<iframe[^>]*src\s*=\s*('|"){0,1}\w*\.(pdf)\s*('|"){0,1}[^>]*(width|height)\s*=\s*('|"){0,1}[0-9]\W('|"){0,1}]]></regexp>
			</search>
		</rule>

		<rule name="HTML.PDFinIframe.B" weight="20">
			<desp>HTML Signature/The postfix of src in iframe is PDF</desp>
			<search target="static">
				<pre-match>iframe</pre-match>
				<regexp><![CDATA[<iframe[^>]*(width|height)\s*=\s*('|"){0,1}[0-9]\W('|"){0,1}[^>]*src\s*=\s*('|"){0,1}\w*\.pdf\s*('|"){0,1}]]></regexp>
			</search>
		</rule>

		<rule name="HTML.SWFinIframe.B" weight="0" feedback="1">
			<desp>HTML Signature/The postfix of src in iframe is SWF</desp>
			<search target="static">
				<pre-match>iframe</pre-match>
				<regexp><![CDATA[<iframe[^>]*(width|height)\s*=\s*('|"){0,1}[0-9]\W('|"){0,1}[^>]*src\s*=\s*('|"){0,1}\w*\.swf\s*('|"){0,1}]]></regexp>
			</search>
		</rule>
		
		<rule name="JS.SwfInImage.A" weight="0" feedback="1">
			
				<search target="method">
					<pre-match>write</pre-match>
					<search target="object">
						<match>document</match>
					</search>
					<search target="param">
						<regexp><![CDATA[\<img\s*[^\<\>]{0,50}src\s*=\s*[a-zA-Z0-9_]{1,50}\.(swf|pdf|jar|class|exe|dll)]]></regexp>
					</search>
				</search>
			
		</rule>

		
		<rule name="HTML.dmac.A" weight="20">
			<desp>HTML Signature/The value is dmac</desp> 
			<search target="static">
				<pre-match>applet</pre-match>
				<match>dmac</match>
				<regexp><![CDATA[<applet[^>]*>\s*<param\s*name\s*=\s*('|"){0,1}(dmac|msize)('|"){0,1}[^>]*value\s*=\s*('|"){0,1}[\w]*[?%:]]]></regexp>
			</search>
		</rule>

		<rule name="HTML.FTPInIframeApplet.A" weight="0" feedback="1">
			<search target="all">
				<pre-match>ftp</pre-match>
				<regexp><![CDATA[<(iframe|applet)[^<>]*(src|archive)\s*=\s*('|")ftp:\/\/[^<>\'\"]*('|")]]></regexp>
			</search>
		</rule>

		<rule name="JS.ArgumentsCallee.A" weight="0" feedback="1">
			<search target="static">
				<pre-match>arguments</pre-match>
				<regexp><![CDATA[arguments\.callee\.tostring\(\)]]></regexp>
			</search>
		</rule>		

		<rule name="JS.RepeatedCreateElementImg.A" weight="0" feedback="1">
			<desp>IE8 zero day</desp>
			<search target="static">
				<pre-match>createelement</pre-match>
				<regexp><![CDATA[(while|for)[\s\S]{1,50}\{[\s\S]{0,200}document\.createelement\(['"]img['"]\)[\s\S]{1,100}\}[\s\S]{1,100}<embed[\s\S]{1,50}\.swf]]></regexp>
			</search>
		</rule>
        
        <rule name="JS.UnknownEK.D" weight="0" feedback="1">
            <search target="static">
                <pre-match>getelementsbytagname</pre-match>
                <regexp><![CDATA[<div>[\d]{2000}]]></regexp>
            </search>
        </rule>
        
        <rule name="JS.UnknownEK.E" weight="0" feedback="1">
            <search target="static">
                <pre-match>getelementsbytagname</pre-match>
                <regexp><![CDATA[(<div>[\d]{1,200}</div>){20}]]></regexp>
            </search>
        </rule>
        
        <rule name="JS.UnknownEK.F" weight="0" feedback="1">
            <search target="static">
                <pre-match><![CDATA[<applet]]></pre-match>
                <!--
                    match text like:
                        <applet  archive="FxoNHrLE.jar"  code="XMenshH.class"  width="24"  height="8">
                            <param value="68-QYI&#x002D;&#x002D;5d-UCY&#x002D;&#x002D;70-QYI&#x002D;&#x002D;70-UCY&#x002D;&#x002D;61-QYI&#x002D;&#x002D;6a-UCY&#x002D;&#x002D;70-QYI&#x002D;&#x002D;6b-UCY&#x002D;&#x002D;6f-QYI&#x002D;&#x002D;67-UCY&#x002D;&#x002D;5d-QYI&#x002D;&#x002D;6e-UCY&#x002D;&#x002D;6e-QYI&#x002D;&#x002D;61-UCY&#x002D;&#x002D;6f-QYI&#x002D;&#x002D;6f-UCY&#x002D;&#x002D;39-QYI&#x002D;&#x002D;35-UCY&#x002D;&#x002D;34-QYI&#x002D;&#x002D;" name
                             note: &#x002D;&#x002D; should be double-hyphen
                -->
                <regexp><![CDATA[<applet[^>]{1,200}>\s*<param[\s\S]{1,100}value\s*=\s*['"]([\w]{2})-([\w]{3})--[\w]{2}-([\w]{3})--([\w]{2}-\2--[\w]{2}-\3--){3}]]></regexp>
            </search>
        </rule>
        
	</rule-set>	
	
	<rule-set category="Specific">
        <rule name="JS.GongDa.E" weight="0" feedback="1">
            <search target="static">
                <pre-match>applet</pre-match>
                <regexp><![CDATA[<applet[\s\S]{0,200}(weight|height)\s*=['"]?\d\D[\s\S]{0,200}<param[\s\S]{0,100}value\s*=\s*['"][0-9A-Za-z]{800}]]></regexp>
            </search>
        </rule>

        <rule name="JS.GongDa.F" weight="0" feedback="1">
            <search target="static">
                <pre-match>applet</pre-match>
                <regexp><![CDATA[<applet[\s\S]{0,300}?<param[\s\S]{0,100}?value\s*=\s*['"][^'"]{0,10}(woyouyi|xiaomaol)]]></regexp>
            </search>
        </rule>
        
        <rule name="JS.MagnitudeEK.D" weight="0" feedback="1">
            <search target="static">
                <pre-match>applet</pre-match>
                <pre-match>iframe</pre-match>
                <regexp><![CDATA[\s*<html>\s*(<body>)?\s*(<applet[^>]*?>\s*(<param[^>]*?>\s*(</param>)?\s*)*?</applet>\s*)+\s*(<iframe[^>]*?>\s*(</iframe>)?\s*)+\s*(</body>)?\s*</html>]]></regexp>
            </search>
        </rule>

		<rule name="JS.CVE-2009-0187.A" weight="20">
			<search target="static">
				<pre-match>3f1d494b-0cef-4468-96c9-386e2e4dec90</pre-match>
				<match>download</match>
				<regexp><![CDATA[<script[\s\S]*(?!&lt;script)new\s+string\(\s*('http://[^\']{1000,}\.com'|"http://[^\"]{1000,}\.com")\s*\)]]></regexp>
			</search>
		</rule>
		
		<rule name="JS.CVE-2009-1568.A" weight="20">
			<desp>CVE-2009-1568,CVE-2009-1569</desp>
			<search target="static">
				<match>36723f97-7aa0-11d4-8919-ff2d71d0d32c</match>
				<pre-match>op-client-interface-version</pre-match>
				<pre-match>op-client-version-info</pre-match>
				<pre-match>op-client-is-printer-installed</pre-match>
				<pre-match>op-user-get-role</pre-match>
				<pre-match>op-printer-install</pre-match>
				<pre-match>op-printer-remove</pre-match>
				<pre-match>op-printer-get-status</pre-match>
				<pre-match>op-printer-get-info</pre-match>
				<pre-match>op-printer-pause</pre-match>
				<pre-match>op-printer-resume</pre-match>
				<pre-match>op-printer-purge-jobs</pre-match>
				<pre-match>op-printer-list-users-jobs</pre-match>
				<pre-match>op-printer-list-all-jobs</pre-match>
				<pre-match>op-printer-send-test-page</pre-match>
				<pre-match>op-printer-send-file</pre-match>
				<pre-match>op-printer-setup-install</pre-match>
				<pre-match>op-job-get-info</pre-match>
				<pre-match>op-job-hold</pre-match>
				<pre-match>op-job-release-hold</pre-match>
				<pre-match>op-job-cancel</pre-match>
				<pre-match>op-job-restart</pre-match>
				<pre-match>op-dbg-printer-get-all-attrs</pre-match>
				<pre-match>op-dbg-job-get-all-attrs</pre-match>
				<pre-match>target-frame</pre-match>
				<pre-match>persistence</pre-match>
				<regexp><![CDATA[<param\s+name\s*=\s*('|")(target-frame|persistence)('|")\s+value\s*=\s*('[^\']{1500,}|"[^\"]{1500,})]]></regexp>
			</search>
		</rule>
		   	
		<rule name="JS.CVE-2009-3031.A" weight="20">
			<search target="static">
				<pre-match>b44d252d-98fc-4d5c-948c-be868392a004</pre-match>
				<match>.browseandsavefile</match>
				<regexp><![CDATA[<script[\s\S]*(?!&lt;script)unescape\(.{2500,}\)]]></regexp>
			</search>
		</rule>
		
		<rule name="JS.CVE-2010-3552.A" weight="20">
			<search target="static">
				<pre-match>cafeefac-dec7-0000-0000-abcdeffedcba</pre-match>
				<match>launchjnlp</match>
				<match>docbase</match>
				<regexp><![CDATA[<param\s+name\s*=\s*('docbase'|"docbase")\s+value\s*=\s*('[^\']{800,}'|"[^\"]{800,}")]]></regexp>
			</search>
		</rule>
		
		<rule name="JS.CVE-2010-3552.B" weight="20">
			<search target="static">
				<pre-match>docbase</pre-match>
				<match>launchjnlp</match>
				<regexp>docbase\s*=\s*('[^\']{800,}'|"[^\"]{800,}")</regexp>
			</search>
		</rule>
		
		<rule name="JS.CVE-2007-3435.A" weight="20">
			<desp>HTML Signature/milw0rm-4094</desp>
			<search target="static">
				<pre-match>c26d9ca8-6747-11d5-ad4b-c01857c10000</pre-match>
				<match>.beginprint</match>
				<regexp><![CDATA[<script[\s\S]*(?!&lt;script).beginprint\(\s*('[^\']{1000,}'|"[^\"]{1000,}")\s*\)]]></regexp>
			</search>
		</rule>
		
		<rule name="JS.OSVDB-64839.A" weight="20">
			<search target="static">
				<pre-match>f8d07b72-b4b4-46a0-acc0-c771d4614b82</pre-match>
				<match>.addattachments</match>
				<regexp><![CDATA[<script[\s\S]*(?!&lt;script)new\s+string\(\s*('[^\']{1000,}'|"[^\"]{1000,}")\s*\)]]></regexp>
			</search>
		</rule>
		
		<rule name="JS.CVE-2009-3867.A" weight="20">
			<desp>HTML Signature/CVE-2009-3867|CVE-2009-3869</desp>
			<search target="static">
				<pre-match>archive</pre-match>
				<match>applet</match>
				<match>90909090</match>
				<regexp><![CDATA[<param\s+name\s*=\s*('sc'|"sc")\s+value\s*=\s*('[^\']{380,}'|"[^\"]{380,}")]]></regexp>
			</search>
		</rule>
		
		<rule name="JS.CVE-2008-5353.A" weight="20">
			<search target="static">
				<pre-match>archive</pre-match>
				<match>applet</match>
				<match>.jar</match>
				<regexp><![CDATA[<param\s+name\s*=\s*(('(data|jar)')|("(data|jar)"))\s+value\s*=\s*('[^\']{8000,}'|"[^\"]{8000,}")]]></regexp>
			</search>
		</rule>   
		
		<rule name="JS.CVE-2010-0805.A" weight="20">
			<search target="static">
				<pre-match>333c7bc4-460f-11d0-bc04-0080c7055a83</pre-match>
				<match>dataurl</match>
				<match>unescape</match>
				<regexp>%u0c0c%u0c0c|%u0d0d%u0d0d|%u0a0a%u0a0a|\\x0c\\x0c\\x0c\\x0c|\\x0d\\x0d\\x0d\\x0d|\\x0a\\x0a\\x0a\\x0a</regexp>
			</search>
		</rule>

		<rule name="JS.CVE-2010-3747.A" weight="20">
			<search target="static">
				<pre-match>cfcdaa03-8be4-11cf-b84b-0020afbbccfa</pre-match>
				<regexp><![CDATA[<param\s+name\s*=\s*('src'|"src")\s+value\s*=\s*('cdda:[^\']{1000,}'|"cdda:[^\"]{1000,}")]]></regexp>
			</search>
		</rule>
		
		<rule name="JAVA.CVE-2010-4452.B" weight="20">
			<search target="static">
				<pre-match>java\jre6\lib\ext</pre-match>
				<regexp><![CDATA[<applet\s+codebase\s*=\s*('file:[^\n\']*java\\jre6\\lib\\ext'|"file:[^\n\"]*java\\jre6\\lib\\ext")]]></regexp>
			</search>
		</rule> 
	   
		<rule name="JS.CVE-2010-1885.C" weight="20">
			<search target="static">
				<pre-match>6bf52a52-394a-11d3-b153-00c04f79faa6</pre-match>
				<match>.openplayer</match>
				<regexp><![CDATA[<script[\s\S]*(?!&lt;script)\.setattribute\(\s*('uimode'|"uimode")[^\)]+('invisible'|"invisible")\s*\)[\s\S]*\.openplayer]]></regexp>
			</search>
		</rule>
		
		<rule name="JS.CVE-2009-0950.A" weight="20">
			<search target="static">
				<match>document.location.assign</match>
				<regexp><![CDATA[document.location.assign\(('itms://[^\']{500,}'|"itms://[^\"]{500,}")\)]]></regexp>
			</search>
		</rule>
		
		<rule name="JS.CVE-2008-4844.A" weight="10" feedback="1">
			<desp>MS08-078</desp>
			<search target="static">
				<pre-match>XML</pre-match>
				<regexp><![CDATA[<xml[\s]+id[\s]*=[\s]*i>[\s]*<x>[\s]*<c>[\s\S]{1,20}image[\s]+src[\s]*=]]></regexp>
			</search>
		</rule>
		
		<rule name="JS.CVE-2008-4844.B" weight="5" feedback="1">
			<desp>MS08-078</desp>
			<search target="static">
				<pre-match>dll</pre-match>
				<regexp><![CDATA[<object\s+classid\s*=\s*('|")[^\'\"]{1,100}\.dll[^\'\"]{1,200}('|")\s*>]]></regexp>
			</search>
		</rule>
		
		<rule name="JS.CVE-2004-1043.A" weight="10" feedback="1">
			<search target="static">
				<pre-match>adb880a6-d8ff-11cf-9377-00aa003b7a11</pre-match>
				<regexp><![CDATA[windows[\s\S]{1,10}pchealth[\s\S]{1,10}helpctr[\s\S]{1,10}system]]></regexp>
			</search>
		</rule>
		
		<rule name="JS.CVE-2008-3008.A" weight="5" feedback="1">
			<search target="static">
				<pre-match>A8D3AD02-7508-4004-B2E9-AD33F087F43C</pre-match>
				<match>getdetailsstring</match>
			</search>
		</rule>
		
		<rule name="JS.CVE-2008-1472.A" weight="5" feedback="1">
			<search target="static">
				<pre-match>BF6EFFF3-4558-4C4C-ADAF-A87891C5F3A3</pre-match>
				<match>.addcolumn</match>
			</search>
		</rule>
		
		<rule name="JS.CVE-2008-1309.A" weight="5" feedback="1">
			<search target="static">
				<pre-match>2F542A2E-EDC9-4BF7-8CB1-87C9919F7F93</pre-match>
				<match>.console</match>
			</search>
		</rule>
		
		<rule name="JS.CVE-2008-0624.B" weight="5" feedback="1">
			<search target="static">
				<pre-match>5f810afc-bb5f-4416-be63-e01dd117bd6c</pre-match>
				<regexp><![CDATA[\.(addbutton|addimage)\(('|")http:\/\/]]></regexp>
			</search>
		</rule>
		
		<rule name="JS.CVE-2008-0015.A" weight="5" feedback="1">
			<search target="script">
				<pre-match>f9769a06-7aca-4e39-9cfb-97bb35f0e77e</pre-match>
				<pre-match>8a674b4d-1f63-11d3-b64c-00c04f79498e</pre-match>
				<pre-match>0369B4E5-45B6-11D3-B650-00C04F79498E</pre-match>
				<pre-match>0369B4E6-45B6-11D3-B650-00C04F79498E</pre-match>
				<pre-match>055CB2D7-2969-45CD-914B-76890722F112</pre-match>
				<pre-match>0955AC62-BF2E-4CBA-A2B9-A63F772D46CF</pre-match>
				<pre-match>15D6504A-5494-499C-886C-973C9E53B9F1</pre-match>
				<pre-match>59DC47A8-116C-11D3-9D8E-00C04F72D980</pre-match>
				<pre-match>8A674B4C-1F63-11D3-B64C-00C04F79498E</pre-match>
				<pre-match>8A674B4D-1F63-11D3-B64C-00C04F79498E</pre-match>
				<pre-match>A2E30750-6C3D-11D3-B653-00C04F79498E</pre-match>
				<pre-match>B64016F3-C9A2-4066-96F0-BD9563314726</pre-match>
				<pre-match>C6B14B32-76AA-4A86-A7AC-5C79AAF58DA7</pre-match>
				<pre-match>F9769A06-7ACA-4E39-9CFB-97BB35F0E77E</pre-match>
				<match>classid</match>
			</search>
		</rule>
		
		<rule name="JS.CVE-2007-5779.A" weight="5" feedback="1">
			<search target="static">
				<pre-match>dc07c721-79e0-4bd4-a89f-c90871946a31</pre-match>
				<match>.openurl</match>
			</search>
		</rule>
		
		<rule name="JS.CVE-2007-4336.A" weight="5" feedback="1">
			<search target="static">
				<pre-match>201EA564-A6F6-11D1-811D-00C04FB6BD36</pre-match>
				<match>.reload</match>
			</search>
		</rule>
		
		<rule name="OSVDB-54706" weight="5" feedback="1">
			<search target="static">
				<pre-match>fe0bd779-44ee-4a4b-aa2e-743c63f2e5e6</pre-match>
				<match>.convertfile</match>
			</search>
		</rule>
		
		<rule name="JS.CVE-2005-2265.A" weight="5" feedback="1">
			<search target="static">
				<pre-match>installversion</pre-match>
				<regexp><![CDATA[installversion[\s\)]\.compareto\(\s*new]]></regexp>
			</search>
		</rule>
			
		<rule name="JS.CVE-2007-3147.A" weight="5" feedback="1">
		   <desp>HTML Signature/CVE-2007-3147</desp>
		   <search target="static">
			   <pre-match>dce2f8b1-a520-11d4-8fd0-00d0b7730277</pre-match>
			   <match>.server</match>
			   <match>.send</match>
		   </search>
		</rule>
		
		<rule name="JS.CVE-2007-2222.A" weight="5" feedback="1">
		   <desp>HTML Signature/CVE-2007-2222</desp>
		   <search target="static">
			   <pre-match>eee78591-fe22-11d0-8bef-0060081841de</pre-match>
			   <match>.findengine</match>
		   </search>
		</rule> 
		
		<rule name="JS.CVE-2007-0018.A" weight="5" feedback="1">
		   <desp>HTML Signature/CVE-2007-0018</desp>
		   <search target="static">
			   <pre-match>77829f14-d911-40ff-a2f0-d11db8d6d0bc</pre-match>
			   <match>.setformatlikesample</match>
		   </search>
		</rule>
		
		<rule name="JS.CVE-2010-3962.A" weight="0" feedback="1">
			<search target="script">
				<pre-match>clip:rect</pre-match>
				<regexp><![CDATA[<table\s*style\s*=\s*position:absolute;\s*clip:rect\(\d+\)>]]></regexp>
			</search>
		</rule>

		<rule name="JS.CVE-2014-1815.A" weight="0" feedback="1">
		   <search target="static">
			   <pre-match>onload</pre-match>
			   <pre-match>onresize</pre-match>
			   <match>marquee</match>
			   <match>createtextnode</match>
			   <match>applyelement</match>
			   <match>createelement</match>
		   </search>
		</rule>

		<rule name="JS.CVE-2014-1815.B" weight="0" feedback="1">
		   <search target="static">
			   <match>marquee</match>
			   <match>collectgarbage</match>
		   </search>
		</rule>

		<rule name="Incognito.A" weight="20">
			<search target="static">
				<pre-match>applet</pre-match>
				<regexp><![CDATA[<applet[^>]*archive\s*=\s*('|"){0,1}[^'">]*osa.pl/[^'">]*('|"){0,1}]]></regexp>
			</search>
		</rule>

		<rule name="Incognito.B" weight="20">
			<search target="static">
				<pre-match>applet</pre-match>
				<regexp><![CDATA[<applet[^>]*>\s*<param\s*name\s*=\s*('|"){0,1}[0-9a-f]{8,8}('|"){0,1}[^>]*value\s*=\s*('|"){0,1}[0-9a-f]{32,32}('|"){0,1}]]></regexp>
			</search>
		</rule>

		<rule name="Incognito.C" weight="20">
			<search target="static">
				<pre-match>applet</pre-match>
				<regexp><![CDATA[<applet[^>]*>\s*<param[^>]*>\s*<param[^>]*value\s*=\s*('|"){0,1}7ggm3aa]]></regexp>
			</search>
		</rule>

		<rule name="JS.CVE-2010-1799.A" weight="20">
			<search target="static">
				<match>hlgco://</match>
				<regexp><![CDATA[<img\s*src\s*=\s*"hlgco://[^\"]{5000,}]]></regexp>
			</search>
		</rule>
		
		<rule name="JS.CVE-2008-2551.A" weight="20">
			<search target="static">
				<match>c1b7e532-3ecb-4e9e-bb3a-2951ffe67c61</match>
				<regexp><![CDATA[<object[^<>]{1,200}(width|height)\s*=\s*('|")[0-9]('|")[^<>]{1,200}c1b7e532-3ecb-4e9e-bb3a-2951ffe67c61[\s\S]{1,600}name\s*=\s*('|")propdownloadurl('|")\s*value\s*=\s*('|")http[^\'\"]*\.exe"[\s\S]{1,200}name\s*=\s*('|")proppostdownloadaction('|")\s*value\s*=\s*('|")run('|")]]></regexp>
			</search>
		</rule>

		<rule name="JS.CVE-2012-1889.B" weight="0" feedback="1">
			<search target="static">
				<pre-match>f6d90f11-9c73-11d3-b32e-00c04f990bb4</pre-match>
				<regexp><![CDATA[\.nameProp[\s\S]{1,200}\.definition]]></regexp>
			</search>
		</rule>

		<rule name="JS.CVE-2012-2522.A" weight="0" feedback="1">
			<search target="static">
				<pre-match>execcommand</pre-match>
				<match>focus</match>
				<match>innerhtml</match>
				<match>removenode</match>
				<regexp><![CDATA[\.focus\(\)[\s\S]{1,200}\.innerhtml\s*=\s*(""|'')[\s\S]{1,200}\.execcommand\([\'\"]delete[\'\"]\)[\s\S]{1,200}\.removenode\(true\)[\s\S]{1,200}\.execcommand\([\'\"]selectall[\'\"]\)]]></regexp>
			</search>
		</rule>	
	
		<rule name="JS.IE8ZeroDayYMjf.A" weight="20">
			<desp>IE8 zero day</desp>
			<search target="static">
				<pre-match>document.execcommand</pre-match>
				<regexp><![CDATA[src[\s\S]{0,10}=\s*['"]ymjf\\u0c08\\u0c0ckdogjsiiejengnekopdjfijdiwuazdfghjaauufggbsipppudfjksoqjgh['"]]]></regexp>
			</search>
		</rule>

		<rule name="JS.CVE-2012-1539.A" weight="0" feedback="1">
			<search target="static">
				<pre-match>.reload()</pre-match>
				<match>first-line</match>
				<match>-ms-block-progression</match>
				<regexp><![CDATA[<div\s*style\s*=]]></regexp>
			</search>
		</rule>	

		<rule name="JS.CVE-2014-1776.A" weight="0" feedback="1">
			<search target="static">
				<match>urn:schemas-microsoft-com:vml</match>
				<match>.onpropertychange</match>
				<match>.removenode</match>
			</search>
		</rule>	

		<rule name="JS.CVE-2014-1776.C" weight="0" feedback="1">
			<search target="static">
				<match>url(#default#vml)</match>
                <regexp><![CDATA[<v:\w+ id]]></regexp>
				<match>.disabled</match>
				<match>.offsetparent</match>
				<match>.firstchild.nextsibling</match>
			</search>
		</rule>	

		<rule name="JS.CVE-2014-1776.D" weight="0" feedback="1">
			<search target="static">
				<match>url(#default#vml)</match>
                <regexp><![CDATA[<v:\w+ id]]></regexp>
				<match>otiek()</match>
				<match>dword2data</match>
				<match>write_addr</match>
			</search>
		</rule>	

		<rule name="JS.juice-sweet-orange.A" weight="0" feedback="1">
			<search target="static">
				<pre-match>applet</pre-match>
				<regexp><![CDATA[<applet[\s\S]{1,200}<param\s*value\s*=\s*("|')[^\'\"]{500,}[\s\S]{0,1000}document\.write\([^\(\)]{0,200}src\s*=]]></regexp>
			</search>
		</rule>
	</rule-set>
</rule-set>

<rule-set category="CVE Info">
	<rule name="JS.CVE-2012-0003.A" weight="0" feedback="1" >
		<search target="static">
			<pre-match>.cloneNode</pre-match>
			<regexp><![CDATA[<embed\s*src\s*=\s*('|")[^\'\"]{1,100}\.mid('|")[\s\S]{0,3000}\.clonenode[\s\S]{0,1000}collectgarbage\([\s\S]{0,200}\.play\(]]></regexp>
		</search>
	</rule>
	
	<rule name="JS.CVE-2012-0003.B" weight="0" feedback="1" >
		<search target="static">
			<pre-match>.cloneNode</pre-match>
			<regexp><![CDATA[\.clonenode[\s\S]{0,1000}collectgarbage\([\s\S]{0,500}\.play\(]]></regexp>
		</search>
	</rule>
	
	<rule name="JS.CVE-2012-0003.C" weight="0" feedback="1" >
		<search target="static">
			<pre-match>.cloneNode</pre-match>
			<match>.play</match>
			<match>collectgarbage</match>
		</search>
	</rule>
	
	<rule name="JS.CVE-2012-0198.A" weight="0" feedback="1" >
		<search target="static">
			<pre-match>.RunAndUploadFile</pre-match>
		</search>
	</rule>
	
	<rule name="JS.CVE-2012-0198.B" weight="0" feedback="1" >
		<search target="script">
			<pre-match>.RunAndUploadFile</pre-match>
		</search>
	</rule>	

	<rule name="JS.CVE-2012-1775.A" weight="0" feedback="1" >
		<search target="static">
			<pre-match>mms://</pre-match>
			<regexp><![CDATA[=\s*('|")mms:\/\/[^\'\"]{1000,}]]></regexp>
		</search>
	</rule>	
	
	<rule name="JS.CVE-2012-1858.A" weight="0" feedback="1" >
		<search target="static">
			<pre-match>tostatichtml(</pre-match>
		</search>
	</rule>

	<rule name="JS.CVE-2012-1858.B" weight="0" feedback="1" >
		<search target="script">
			<pre-match>tostatichtml(</pre-match>
		</search>
	</rule>
	
	<rule name="JS.CVE-2012-1875.A" weight="0" feedback="1" >
		<search target="script">
			<pre-match>.innerhtml</pre-match>
			<regexp><![CDATA[\.innerhtml\s*=\s*[^=]{1,40}\.innerhtml[\s\S]{1,500}\.src\s*=\s*('|")\s*('|")]]></regexp>
		</search>
	</rule>
	
	<rule name="JS.CVE-2012-1876.A" weight="0" feedback="0.01" >
		<search target="static">
		    <pre-match>col</pre-match>
			<regexp><![CDATA[\.span\s*=]]></regexp>		
		</search>
	</rule>
	
	<rule name="JS.CVE-2012-1878.A" weight="0" feedback="1" >
		<search target="script">
			<pre-match>onbeforedeactivate</pre-match>
			<match>.removechild</match>
			<match>collectgarbage</match>
		</search>
	</rule>
	
	<rule name="JS.CVE-2012-1879.A" weight="0" feedback="1" >
		<search target="script">
			<pre-match>insertadjacenttext</pre-match>
			<match>getelementby</match>
		</search>
	</rule>
	
	<rule name="JS.CVE-2012-1881.A" weight="0" feedback="1" >
		<search target="script">
			<pre-match>onrowsdelete</pre-match>
			<pre-match>onrowsinsert</pre-match>
			<match>.removechild</match>
			<match>collectgarbage</match>
		</search>
	</rule>
	
	<rule name="JS.CVE-2012-2521.A" weight="0" feedback="1" >
		<search target="static">
			<pre-match>mailto:</pre-match>
			<match>.onreadystatechange</match>
			<match>getelementby</match>
			<match>.removechild</match>		
		</search>
	</rule>
	
	<rule name="JS.CVE-2012-2522.A" weight="0" feedback="1" >
		<search target="script">
			<pre-match>selectall</pre-match>
			<match>.removenode(</match>
			<match>.execcommand</match>
			<regexp><![CDATA[\.innerhtml\s*=\s*('|")\s*('|")]]></regexp>		
		</search>
	</rule>
	
	<rule name="JS.CVE-2012-4787.B" weight="0" feedback="1" >
		<search target="script">
			<pre-match>.lastChild.style</pre-match>
			<match>collectgarbage</match>
			<match>.outerhtml</match>		
		</search>
	</rule>
		
</rule-set>

<url-rules>
	<rule name="url.blackhole.a" weight="0" feedback="1" capture="1">
        <regexp><![CDATA[.*?:8080/forum/links/column.php]]></regexp>
	</rule>
	<rule name="url.magnitude.a" weight="0" feedback="1" capture="1">
        <regexp><![CDATA[.*?\?[a-f0-9]{32}\=[0-9]{2}$]]></regexp>
    </rule>
	<rule name="url.neutrino.a" weight="0" feedback="1" capture="1">
        <regexp><![CDATA[.*?:8000/[a-z]{5,}\?[a-z]{5,}\=([0-9]{6,7}|[a-z]{6,})$]]></regexp>
    </rule>
	<rule name="url.redkit.a" weight="0" feedback="1" capture="1">
        <regexp><![CDATA[.*?/[a-z]{4}.html?\?[hij]{1}=[0-9]{6,7}$]]></regexp>
    </rule>
</url-rules>

</xmlpattern>
